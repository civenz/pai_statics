(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6810],{50921:function(n,e,t){"use strict";t.d(e,{Sx:function(){return X},Xv:function(){return D},UC:function(){return R},uA:function(){return U},QI:function(){return A},p$:function(){return E},Rz:function(){return B},pk:function(){return H},Ys:function(){return M},L4:function(){return V},uS:function(){return Z},Nv:function(){return Q},ME:function(){return z},iw:function(){return G},NF:function(){return Y},vG:function(){return J},AX:function(){return O},uk:function(){return T},ad:function(){return W}});var r=t(45008),a=t(2559);function s(){let n=(0,r._)(["\n  fragment postListItemFragment on Post {\n    id\n    title\n    slug\n    summary\n    url\n    cover_image\n    publish_status\n    view_count\n    status\n    status_desc\n    created_at\n    published_at\n    publish_at_diff_humans\n    deleted_at\n  }\n"]);return s=function(){return n},n}function u(){let n=(0,r._)(["\n  fragment paginatorInfoFragment on PaginatorInfo {\n    count\n    currentPage\n    firstItem\n    hasMorePages\n    lastItem\n    lastPage\n    perPage\n    total\n  }\n"]);return u=function(){return n},n}function i(){let n=(0,r._)(["\n  fragment replayPageInfoFragment on PageInfo {\n      endCursor\n      count\n      currentPage\n      hasNextPage\n      hasPreviousPage\n      lastPage\n      startCursor\n      total\n    }\n"]);return i=function(){return n},n}let o=(0,a.Ps)(s()),l=(0,a.Ps)(u()),c=(0,a.Ps)(i());function d(){let n=(0,r._)(["\n  query GetPostsByCategory(\n    $category: String\n    $first: Int = 10\n    $after: String\n  ) {\n    posts(first: $first, after: $after, term_ids: $category) {\n      edges {\n        cursor\n        node {\n          ...postListItemFragment\n          user {\n            name\n          }\n          team {\n            slug\n            name\n          }\n          tags {\n            name\n            slug\n          }\n        }\n      }\n      pageInfo {\n        ...replayPageInfoFragment\n      }\n    }\n  }\n  ","\n  ","\n"]);return d=function(){return n},n}function f(){let n=(0,r._)(["\n  query GetCategorys {\n    categories {\n      id\n      name\n      slug\n    }\n  }\n"]);return f=function(){return n},n}function m(){let n=(0,r._)(["\n  query GetNews($first: Int = 20, $after: String) {\n    posts(first: $first, show_mode: News, after: $after) {\n      edges {\n        cursor\n        node {\n          ...postListItemFragment\n        }\n      }\n      pageInfo {\n        ...replayPageInfoFragment\n      }\n    }\n  }\n  ","\n  ","\n"]);return m=function(){return n},n}function g(){let n=(0,r._)(["\n  query GetPost($slug: String!) {\n    post(slug: $slug) {\n      ...postListItemFragment\n      body\n      source_url\n      user {\n        name\n        nickname\n        image\n      }\n      team {\n        slug\n        name\n        description\n        avatar\n      }\n      tags {\n        name\n        slug\n      }\n    }\n  }\n  ","\n"]);return g=function(){return n},n}function _(){let n=(0,r._)(["\n  query GetPosts(\n    $first: Int = 20\n    $after: String\n    $show_mode: PostShowMode\n    $type: PostType\n    $category: String\n    $tag: String\n  ) {\n    posts(\n      first: $first\n      after: $after\n      show_mode: $show_mode\n      type: $type\n      term_ids: $category\n      tag_ids: $tag\n    ) {\n      edges {\n        cursor\n        node {\n          ...postListItemFragment\n          user {\n            name\n            nickname\n            image\n          }\n          team {\n            slug\n            name\n            avatar\n          }\n          tags {\n            name\n            slug\n          }\n        }\n      }\n      pageInfo {\n        ...replayPageInfoFragment\n      }\n    }\n  }\n  ","\n  ","\n"]);return _=function(){return n},n}function p(){let n=(0,r._)(["\n  query MyPosts(\n    $first: Int!\n    $page: Int\n    $status: [PostStatus]\n    $publish_status: [PostPublishStatus]\n  ) {\n    viewer {\n      name\n      email\n      posts(\n        first: $first\n        page: $page\n        status: $status\n        publish_status: $publish_status\n      ) {\n        data {\n          ...postListItemFragment\n        }\n        paginatorInfo {\n          ...paginatorInfoFragment\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return p=function(){return n},n}function h(){let n=(0,r._)(["\n  query GetHotTags {\n    hotTags {\n      id\n      name\n      slug\n    }\n  }\n"]);return h=function(){return n},n}function v(){let n=(0,r._)(["\n  mutation DeletePost($id: ID!) {\n    deletePost(id: $id) {\n      id\n      slug\n    }\n  }\n"]);return v=function(){return n},n}function x(){let n=(0,r._)(["\n  query GetTag($slug: String!) {\n    tag(slug: $slug) {\n      id\n      name\n      slug\n    }\n  }\n"]);return x=function(){return n},n}function P(){let n=(0,r._)(["\n  query GetEnum($name: String!) {\n    __type(name: $name) {\n      enumValues {\n        name\n      }\n    }\n  }\n"]);return P=function(){return n},n}function y(){let n=(0,r._)(["\n  query Viewer {\n    viewer {\n      name\n      email\n      image\n    }\n  }\n"]);return y=function(){return n},n}function $(){let n=(0,r._)(["\n  query Me {\n    me {\n      name\n      email\n      image\n      team {\n        name\n        slug\n        description\n        avatar\n        status\n      }\n    }\n  }\n"]);return $=function(){return n},n}function w(){let n=(0,r._)(["\n  mutation LoginUser($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      name\n    }\n  }\n"]);return w=function(){return n},n}function b(){let n=(0,r._)(["\n  mutation Logout {\n    logout {\n      name\n    }\n  }\n"]);return b=function(){return n},n}function N(){let n=(0,r._)(["\n  mutation Upload($file: Upload!) {\n    upload(file: $file)\n  }\n"]);return N=function(){return n},n}function j(){let n=(0,r._)(["\n  mutation RemoteFileUpload($url: String!) {\n    remoteFile(url: $url)\n  }\n"]);return j=function(){return n},n}function I(){let n=(0,r._)(["\n  mutation LoginWxCode {\n    loginWxCode\n  }\n"]);return I=function(){return n},n}function k(){let n=(0,r._)(["\n  mutation LoginWxCheck {\n    loginWxCheck\n  }\n"]);return k=function(){return n},n}function S(){let n=(0,r._)(["\n  query GetQuestion($slug: String!) {\n    question(uuid: $slug) {\n      uuid\n      title\n      body\n      keywords\n      answer_count\n      created_at_diff_humans\n      user {\n        name\n        uuid\n        nickname\n        image\n      }\n      answers {\n        uuid\n        body\n        accepted\n        created_at_diff_humans\n        user {\n          name\n          uuid\n          nickname\n          image\n          description\n        }\n      }\n    }\n    randomQuestions {\n      uuid\n      title\n      body\n      keywords\n      answer_count\n      created_at_diff_humans\n    }\n  }\n"]);return S=function(){return n},n}function C(){let n=(0,r._)(["\n  query GetQuestions($first: Int = 20, $after: String) {\n    questions(first: $first, after: $after) {\n      edges {\n        cursor\n        node {\n          uuid\n          title\n          body\n          keywords\n          answer_count\n          created_at_diff_humans\n          user {\n            name\n            nickname\n          }\n        }\n      }\n      pageInfo {\n        ...replayPageInfoFragment\n      }\n    }\n    randomQuestions {\n      uuid\n      title\n      body\n      keywords\n      answer_count\n      created_at_diff_humans\n    }\n  }\n  ","\n"]);return C=function(){return n},n}function F(){let n=(0,r._)(["\n  mutation CreatePost($input: CreatePostInput) {\n    createPost(input: $input) {\n      id\n      title\n      body\n      publish_status\n      status\n      slug\n      user {\n        name\n      }\n    }\n  }\n"]);return F=function(){return n},n}function q(){let n=(0,r._)(["\n  mutation UpdatePost($id: ID!, $input: UpdatePostInput!) {\n    updatePost(id: $id, input: $input) {\n      ...postListItemFragment\n      body\n    }\n  }\n  ","\n"]);return q=function(){return n},n}function L(){let n=(0,r._)(["\n  mutation UpdateUser($input: UpdateUserInput!) {\n    updateUser(input: $input) {\n      uuid\n      name\n    }\n  }\n"]);return L=function(){return n},n}(0,a.Ps)(d(),o,c),(0,a.Ps)(f());let U=(0,a.Ps)(m(),o,c),A=(0,a.Ps)(g(),o),E=(0,a.Ps)(_(),o,c),G=(0,a.Ps)(p(),o,l);(0,a.Ps)(h());let D=(0,a.Ps)(v());(0,a.Ps)(x());let R=(0,a.Ps)(P()),W=(0,a.Ps)(y()),z=(0,a.Ps)($()),M=(0,a.Ps)(w()),Q=(0,a.Ps)(b()),T=(0,a.Ps)(N()),Y=(0,a.Ps)(j()),Z=(0,a.Ps)(I()),V=(0,a.Ps)(k()),B=(0,a.Ps)(S()),H=(0,a.Ps)(C(),c),X=(0,a.Ps)(F()),J=(0,a.Ps)(q(),o),O=(0,a.Ps)(L())},7451:function(n,e,t){"use strict";t.d(e,{ResponsiveLinks:function(){return u}});var r=t(57437),a=t(2265),s=t(95011);function u(){let[n,e]=(0,a.useState)(),t=(0,a.useRef)(),[,u]=(0,s.Z)(()=>{n&&t.current&&t.current.forEach(e=>{n<900?e.removeAttribute("target"):e.setAttribute("target","_blank")})},500,[n]);return(0,a.useEffect)(()=>{t.current||(t.current=document.querySelectorAll('a[target="_blank"]'),e(window.innerWidth));let n=()=>{e(window.innerWidth)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),u()}},[u]),(0,r.jsx)(r.Fragment,{})}},44621:function(n,e,t){"use strict";t.d(e,{SitePost:function(){return h}});var r=t(57437),a=t(2265),s=t(33145),u=t(27648),i=t(99376),o=t(54992),l=t(92369),c=t(49089),d=t(28819),f=t(94508),m=t(50921),g=t(84077),_=t.n(g),p=t(16831);function h(n){let{categories:e,term:t}=n,s=0,[l,c]=(0,a.useState)(!1);t&&(s=e.findIndex(n=>n.slug===t.slug));let[g,p]=(0,a.useState)(s),h=(0,a.useDeferredValue)(g),x=e[h],{data:{posts:P},fetchMore:y}=(0,o.kJ)(m.p$,{variables:{category:x.id,show_mode:"Zhuanlan"}}),[$,w]=(0,a.useState)({[g]:P}),b=P.pageInfo,N=(0,i.useRouter)();(0,a.useEffect)(()=>{w(n=>({...n,[g]:P})),b.currentPage%4==0?c(!1):c(!0)},[g,P,b]);let j=(0,a.useCallback)(()=>{b.hasNextPage&&y&&(c(!0),null==y||y({variables:{after:b.endCursor,category:x.id,show_mode:"Zhuanlan"}}).then(()=>{b.currentPage%4==0?c(!1):c(!0)}))},[y,b.hasNextPage,b.currentPage,b.endCursor,x.id]);return(0,r.jsxs)("div",{className:"mt-5",children:[(0,r.jsx)("div",{className:(0,f.cn)("flex items-center justify-between gap-5 overflow-x-auto overflow-y-hidden border-b text-lg md:gap-0",t?"".concat(_().second__term__nav):""),children:e.map((n,e)=>(0,r.jsx)(u.default,{href:"/".concat(n.slug),className:(0,f.cn)("relative whitespace-nowrap pb-3",g===e&&"".concat(_().nav__active," text-primary"),g===e&&t&&_().nav__term__active,t&&"hover:text-primary"),onClick:async r=>{if(p(e),t){""==n.slug&&(r.preventDefault(),N.push("/guancha"));return}r.preventDefault()},children:t&&""==n.slug?"最新观察":n.name},e))}),t&&(0,r.jsx)("div",{className:"redDot mb-0 hidden xl:flex",children:x.name}),(0,r.jsxs)("div",{children:[e.map((n,e)=>(null==P||P.edges,(0,r.jsx)(v,{posts:$[e],className:(0,f.cn)(h===e?"block":"hidden",h!==g?"opacity-30":"")},e))),(0,r.jsx)(d.df,{as:"div",onChange:(n,e)=>{n&&(null==b?void 0:b.hasNextPage)&&l&&y({variables:{after:b.endCursor}})},children:b?(0,r.jsx)("div",{className:"mt-4 text-center",children:(null==b?void 0:b.hasNextPage)?(0,r.jsx)("span",{onClick:j,className:"cursor-pointer underline hover:text-red-600",children:"加载更多"}):(0,r.jsx)("span",{children:"没有更多了"})}):(0,r.jsx)("div",{className:"mt-4 text-center",children:"加载中..."})})]})]})}function v(n){let{posts:e,className:t}=n,a=(null==e?void 0:e.edges)||[];return(0,r.jsx)("div",{className:t,children:a.map((n,e)=>{let{node:t}=n;return(0,r.jsxs)("div",{className:"relative flex gap-5 py-2 xl:-mx-5 xl:p-5 xl:hover:shadow-[0_0_12px_0_rgba(0,0,0,0.2)]",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm leading-tight md:text-[22px] ",children:(0,r.jsx)(u.default,{href:t.url,target:"_blank",className:"hover:text-primary",children:t.title})}),(0,r.jsx)("div",{className:"mt-2 hidden break-all text-sm text-muted-foreground md:line-clamp-2",children:t.summary})]}),(0,r.jsxs)("div",{className:"mt-1 flex items-center text-sm",children:[(0,r.jsxs)(p.Avatar,{className:"mr-2 hidden size-6 md:block",children:[(0,r.jsx)(p.AvatarImage,{src:t.team.avatar||void 0}),(0,r.jsx)(p.AvatarFallback,{children:(0,r.jsx)(l.Z,{size:24})})]}),(0,r.jsx)("div",{className:"text-muted-foreground",children:t.team.name}),(0,r.jsx)("div",{className:"ml-3 text-muted-foreground",children:t.publish_at_diff_humans}),(0,r.jsxs)("div",{className:"ml-auto hidden items-center gap-2 text-muted-foreground md:flex",children:[t.tags.length?(0,r.jsx)(c.fxx,{size:13}):"",t.tags.map((n,e)=>(0,r.jsx)(u.default,{href:"/search?posts_dsb%5Bquery%5D=".concat(n.name),target:"_blank",className:"hover:underline",rel:"nofollow",children:n.name},n.slug))]})]})]}),t.cover_image&&(0,r.jsx)("div",{children:(0,r.jsx)(u.default,{href:t.url,target:"_blank",className:"relative block h-0 w-[100px] pt-[56.25%] md:w-[230px]",children:(0,r.jsx)(s.default,{src:t.cover_image,alt:t.title,fill:!0,style:{objectFit:"cover"}})})})]},e)})})}},16831:function(n,e,t){"use strict";t.d(e,{Avatar:function(){return i},AvatarFallback:function(){return l},AvatarImage:function(){return o}});var r=t(57437),a=t(2265),s=t(61146),u=t(94508);let i=a.forwardRef((n,e)=>{let{className:t,...a}=n;return(0,r.jsx)(s.fC,{ref:e,className:(0,u.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a})});i.displayName=s.fC.displayName;let o=a.forwardRef((n,e)=>{let{className:t,...a}=n;return(0,r.jsx)(s.Ee,{ref:e,className:(0,u.cn)("aspect-square h-full w-full",t),...a})});o.displayName=s.Ee.displayName;let l=a.forwardRef((n,e)=>{let{className:t,...a}=n;return(0,r.jsx)(s.NY,{ref:e,className:(0,u.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a})});l.displayName=s.NY.displayName},94508:function(n,e,t){"use strict";t.d(e,{HQ:function(){return u},cn:function(){return s}});var r=t(61994),a=t(53335);function s(){for(var n=arguments.length,e=Array(n),t=0;t<n;t++)e[t]=arguments[t];return(0,a.m6)((0,r.W)(e))}function u(n,e){return"news"==e?n.includes(".html")?"/news-flash/".concat(n):"/news/".concat(n):n.length<7?"/".concat(n,".html"):"/p/".concat(n)}},84077:function(n){n.exports={nav__active:"site-post_nav__active__MmPmY",second__term__nav:"site-post_second__term__nav__cU64O",nav__term__active:"site-post_nav__term__active__lsUD9"}}}]);