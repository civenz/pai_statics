(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6543,2357],{24735:function(e,t,n){Promise.resolve().then(n.bind(n,82689))},82689:function(e,t,n){"use strict";let a;n.r(t),n.d(t,{default:function(){return nd}});var r,l,i=n(57437);n(65353),n(87605);var o=n(2265),s=n(99376),d=n(88540),c=n(63077),u=n(94508);let m=(0,o.memo)(e=>{let{name:t,className:n,strokeWidth:a}=e,r=c[t];return r?(0,i.jsx)(r,{className:(0,u.cn)("size-4",n),strokeWidth:a||2.5}):null});m.displayName="Icon";let p=(0,o.forwardRef)((e,t)=>{let{children:n,className:a,withShadow:r=!0,withBorder:l=!0,...o}=e,s=(0,u.cn)(a,"rounded-lg bg-white dark:bg-black",r?"shadow-sm":"",l?"border border-neutral-200 dark:border-neutral-800":"");return(0,i.jsx)("div",{className:s,...o,ref:t,children:n})});p.displayName="Surface";let h=o.forwardRef((e,t)=>{let{active:n,buttonSize:a="medium",children:r,disabled:l,variant:o="primary",className:s,activeClassname:d,...c}=e,m=(0,u.cn)("group flex items-center justify-center gap-2 whitespace-nowrap rounded-md border border-transparent text-sm font-semibold disabled:opacity-50","primary"===o&&(0,u.cn)("border-black bg-black text-white dark:border-white dark:bg-white dark:text-black",!l&&!n&&"hover:bg-neutral-800 active:bg-neutral-900 dark:hover:bg-neutral-200 dark:active:bg-neutral-300",n&&(0,u.cn)("bg-neutral-900 dark:bg-neutral-300",d)),"secondary"===o&&(0,u.cn)("text-neutral-900 dark:text-white",!l&&!n&&"hover:bg-neutral-100 active:bg-neutral-200 dark:hover:bg-neutral-900 dark:active:bg-neutral-800",n&&"bg-neutral-200 dark:bg-neutral-800"),"tertiary"===o&&(0,u.cn)("bg-neutral-50 text-neutral-900 dark:border-neutral-900 dark:bg-neutral-900 dark:text-white",!l&&!n&&"hover:bg-neutral-100 active:bg-neutral-200 dark:hover:bg-neutral-800 dark:active:bg-neutral-700",n&&(0,u.cn)("bg-neutral-200 dark:bg-neutral-800",d)),"ghost"===o&&(0,u.cn)("border-transparent bg-transparent text-neutral-500 dark:text-neutral-400",!l&&!n&&"hover:bg-black/5 hover:text-neutral-700 active:bg-black/10 active:text-neutral-800 dark:hover:bg-white/10 dark:hover:text-neutral-300 dark:active:text-neutral-200",n&&(0,u.cn)("bg-black/10 text-neutral-800 dark:bg-white/20 dark:text-neutral-200",d)),"medium"===a&&"px-3 py-2","small"===a&&"px-2 py-1","icon"===a&&"size-8","iconSmall"===a&&"size-6",s);return(0,i.jsx)("button",{ref:t,disabled:l,className:m,...c,children:r})});h.displayName="Button";var g=n(42338);let f=navigator.platform.toUpperCase().indexOf("MAC")>=0,x=e=>{let{children:t}=e,n="inline-flex items-center justify-center w-auto h-5 p-1 text-[0.625rem] rounded font-semibold leading-none border border-neutral-200 text-neutral-500 border-b-2";return"Mod"===t?(0,i.jsx)("kbd",{className:n,children:f?"⌘":"Ctrl"}):"Shift"===t?(0,i.jsx)("kbd",{className:n,children:"⇧"}):"Alt"===t?(0,i.jsx)("kbd",{className:n,children:f?"⌥":"Alt"}):(0,i.jsx)("kbd",{className:n,children:t})};var b=e=>{let{children:t,enabled:n=!0,title:a,shortcut:r,tippyOptions:l={}}=e,s=(0,o.useCallback)(e=>(0,i.jsxs)("span",{className:"z-[999] flex items-center gap-2 rounded-lg border border-neutral-100 bg-white px-2.5 py-1 shadow-sm",tabIndex:-1,"data-placement":e["data-placement"],"data-reference-hidden":e["data-reference-hidden"],"data-escaped":e["data-escaped"],children:[a&&(0,i.jsx)("span",{className:"text-xs font-medium text-neutral-500",children:a}),r&&(0,i.jsx)("span",{className:"flex items-center gap-0.5",children:r.map(e=>(0,i.jsx)(x,{children:e},e))})]}),[r,a]);return n?(0,i.jsx)(g.ZP,{delay:500,offset:[0,8],touch:!1,zIndex:99999,appendTo:document.body,...l,render:s,children:(0,i.jsx)("span",{children:t})}):(0,i.jsx)(i.Fragment,{children:t})};let v=(0,o.forwardRef)((e,t)=>{let{shouldShowContent:n=!0,children:a,isVertical:r=!1,className:l,...o}=e,s=(0,u.cn)("inline-flex h-full gap-0.5 leading-none text-black",r?"flex-col p-2":"flex-row items-center p-1",l);return n&&(0,i.jsx)(p,{className:s,...o,ref:t,children:a})});v.displayName="Toolbar";let y=(0,o.forwardRef)((e,t)=>{let{horizontal:n,className:a,...r}=e,l=(0,u.cn)("bg-neutral-200 dark:bg-neutral-800",n?"my-1 h-[1px] w-full min-w-[1.5rem] first:mt-0 last:mt-0":"mx-1 h-full min-h-[1.5rem] w-[1px] first:ml-0 last:mr-0",a);return(0,i.jsx)("div",{className:l,ref:t,...r})});y.displayName="Toolbar.Divider";let k=(0,o.forwardRef)((e,t)=>{let{children:n,buttonSize:a="icon",variant:r="ghost",className:l,tooltip:o,tooltipShortcut:s,activeClassname:d,...c}=e,m=(0,u.cn)("w-auto min-w-[2rem] gap-1 px-2",l),p=(0,i.jsx)(h,{activeClassname:d,className:m,variant:r,buttonSize:a,ref:t,...c,children:n});return o?(0,i.jsx)(b,{title:o,shortcut:s,children:p}):p});k.displayName="ToolbarButton";let j={Wrapper:v,Divider:y,Button:k},w=e=>{let{onClear:t,onEdit:n,url:a}=e;return(0,i.jsxs)(p,{className:"flex items-center gap-2 p-2",children:[(0,i.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-sm underline",children:a}),(0,i.jsx)(j.Divider,{}),(0,i.jsx)(b,{title:"Edit link",children:(0,i.jsx)(j.Button,{onClick:n,children:(0,i.jsx)(m,{name:"Pen"})})}),(0,i.jsx)(b,{title:"Remove link",children:(0,i.jsx)(j.Button,{onClick:t,children:(0,i.jsx)(m,{name:"Trash2"})})})]})};var C=n(8289);let N=(0,o.memo)(e=>{let{color:t,active:n,onColorChange:a}=e,r=(0,u.cn)("group flex items-center justify-center rounded p-1.5",!n&&"hover:bg-neutral-100",n&&"bg-neutral-100"),l=(0,u.cn)("size-4 rounded bg-slate-100 shadow-sm ring-current ring-offset-2",!n&&"hover:ring-1",n&&"ring-1"),s=(0,o.useCallback)(()=>{a&&a(t||"")},[a,t]);return(0,i.jsx)("button",{onClick:s,className:r,children:(0,i.jsx)("div",{style:{backgroundColor:t,color:t},className:l})})});N.displayName="ColorButton";let S=[{name:"academic",label:"Academic",value:"academic"},{name:"business",label:"Business",value:"business"},{name:"casual",label:"Casual",value:"casual"},{name:"childfriendly",label:"Childfriendly",value:"childfriendly"},{name:"conversational",label:"Conversational",value:"conversational"},{name:"emotional",label:"Emotional",value:"emotional"},{name:"humorous",label:"Humorous",value:"humorous"},{name:"informative",label:"Informative",value:"informative"},{name:"inspirational",label:"Inspirational",value:"inspirational"},{name:"memeify",label:"Memeify",value:"meme"},{name:"narrative",label:"Narrative",value:"narrative"},{name:"objective",label:"Objective",value:"objective"},{name:"persuasive",label:"Persuasive",value:"persuasive"},{name:"poetic",label:"Poetic",value:"poetic"}],A=["#ff0000","#ffc000","#fff000","#0070c0","#00b050","#00b0f0"],L=e=>{let{onChange:t,active:n=!1,size:a="large"}=e,r=n?"checked":"unchecked",l=n?"on":"off",s=(0,u.cn)("inline-flex cursor-pointer items-center rounded-full border-transparent transition-colors",n?"bg-black":"bg-neutral-200 hover:bg-neutral-300",n?"dark:bg-white":"dark:bg-neutral-800 dark:hover:bg-neutral-700","small"===a&&"h-3 w-6 px-0.5","large"===a&&"h-5 w-9 px-0.5"),d=(0,u.cn)("pointer-events-none block rounded-full transition-transform","bg-white dark:bg-black","small"===a&&"size-2","large"===a&&"size-4",n?(0,u.cn)("small"===a?"translate-x-3":"","large"===a?"translate-x-4":""):"translate-x-0"),c=(0,o.useCallback)(()=>{t(!n)},[n,t]);return(0,i.jsx)("button",{className:s,type:"button",role:"switch","aria-checked":n,"data-state":r,value:l,onClick:c,children:(0,i.jsx)("span",{className:d,"data-state":r})})},T=e=>{let{initialUrl:t,initialOpenInNewTab:n,onSetLink:a}=e,[r,l]=(0,o.useState)(t||""),[i,s]=(0,o.useState)(n||!1),d=(0,o.useCallback)(e=>{l(e.target.value)},[]),c=(0,o.useMemo)(()=>/^(\S+):(\/\/)?\S+$/.test(r),[r]),u=(0,o.useCallback)(e=>{e.preventDefault(),c&&a(r,i)},[r,c,i,a]);return{url:r,setUrl:l,openInNewTab:i,setOpenInNewTab:s,onChange:d,handleSubmit:u,isValidUrl:c}},P=e=>{let{onSetLink:t,initialOpenInNewTab:n,initialUrl:a}=e,r=T({onSetLink:t,initialOpenInNewTab:n,initialUrl:a});return(0,i.jsxs)(p,{className:"p-2",children:[(0,i.jsxs)("form",{onSubmit:r.handleSubmit,className:"flex items-center gap-2",children:[(0,i.jsxs)("label",{className:"flex cursor-text items-center gap-2 rounded-lg bg-neutral-100 p-2 dark:bg-neutral-900",children:[(0,i.jsx)(m,{name:"Link",className:"flex-none text-black dark:text-white"}),(0,i.jsx)("input",{type:"url",className:"min-w-[12rem] flex-1 bg-transparent text-sm text-black outline-none dark:text-white",placeholder:"输入 URL",value:r.url,onChange:r.onChange})]}),(0,i.jsx)(h,{variant:"primary",buttonSize:"small",type:"submit",disabled:!r.isValidUrl,children:"设置链接"})]}),(0,i.jsx)("div",{className:"mt-3",children:(0,i.jsxs)("label",{className:"flex cursor-pointer select-none items-center justify-start gap-2 text-sm font-semibold text-neutral-500 dark:text-neutral-400",children:["在新选项卡中打开",(0,i.jsx)(L,{active:r.openInNewTab,onChange:r.setOpenInNewTab})]})})]})},M=e=>{let{editor:t,appendTo:n}=e,[a,r]=(0,o.useState)(!1),l=(0,o.useCallback)(()=>t.isActive("link"),[t]),{href:s,target:c}=t.getAttributes("link"),u=(0,o.useCallback)(()=>{r(!0)},[]),m=(0,o.useCallback)((e,n)=>{t.chain().focus().extendMarkRange("link").setLink({href:e,target:n?"_blank":""}).run(),r(!1)},[t]),p=(0,o.useCallback)(()=>(t.chain().focus().extendMarkRange("link").unsetLink().run(),r(!1),null),[t]);return(0,o.useCallback)(()=>{r(!0)},[]),(0,o.useCallback)(()=>{r(!1)},[]),(0,i.jsx)(d.NM,{editor:t,pluginKey:"textMenu",shouldShow:l,updateDelay:0,tippyOptions:{popperOptions:{modifiers:[{name:"flip",enabled:!1}]},appendTo:()=>null==n?void 0:n.current,onHidden:()=>{r(!1)}},children:a?(0,i.jsx)(P,{initialUrl:s,initialOpenInNewTab:"_blank"===c,onSetLink:m}):(0,i.jsx)(w,{url:s,onClear:p,onEdit:u})})};var H=n(27312),I=n(3032);let B=e=>{let{children:t}=e;return(0,i.jsx)("div",{className:"mb-1 px-1.5 text-[.65rem] font-semibold uppercase text-neutral-500 dark:text-neutral-400",children:t})},_=e=>{let{children:t,isActive:n,onClick:a,disabled:r,className:l}=e,o=(0,u.cn)("flex w-full items-center gap-2 rounded bg-transparent p-1.5 text-left text-sm font-medium text-neutral-500 dark:text-neutral-400",!n&&!r,"hover:bg-neutral-100 hover:text-neutral-800 dark:hover:bg-neutral-900 dark:hover:text-neutral-200",n&&!r&&"bg-neutral-100 text-neutral-800 dark:bg-neutral-900 dark:text-neutral-200",r&&"cursor-not-allowed text-neutral-400 dark:text-neutral-600",l);return(0,i.jsx)("button",{className:o,disabled:r,onClick:a,children:t})},z=e=>"option"===e.type,R=e=>"category"===e.type,E=e=>{let{onSetLink:t}=e;return(0,i.jsxs)(H.fC,{children:[(0,i.jsx)(H.xz,{asChild:!0,children:(0,i.jsx)(j.Button,{tooltip:"链接",children:(0,i.jsx)(m,{name:"Link"})})}),(0,i.jsx)(H.VY,{children:(0,i.jsx)(P,{onSetLink:t})})]})},D=[{label:"Sans Serif",options:[{label:"Inter",value:""},{label:"Arial",value:"Arial"},{label:"Helvetica",value:"Helvetica"}]},{label:"Serif",options:[{label:"Times New Roman",value:"Times"},{label:"Garamond",value:"Garamond"},{label:"Georgia",value:"Georgia"}]},{label:"Monospace",options:[{label:"Courier",value:"Courier"},{label:"Courier New",value:"Courier New"}]}],$=D.flatMap(e=>[e.options]).flat(),O=[{label:"较小",value:"12px"},{label:"小",value:"14px"},{label:"中",value:""},{label:"大",value:"18px"},{label:"特大",value:"24px"}],F=e=>{let t=(0,o.useCallback)(()=>e.chain().focus().toggleBold().run(),[e]),n=(0,o.useCallback)(()=>e.chain().focus().toggleItalic().run(),[e]),a=(0,o.useCallback)(()=>e.chain().focus().toggleStrike().run(),[e]),r=(0,o.useCallback)(()=>e.chain().focus().toggleUnderline().run(),[e]),l=(0,o.useCallback)(()=>e.chain().focus().toggleCode().run(),[e]),i=(0,o.useCallback)(()=>e.chain().focus().toggleCodeBlock().run(),[e]),s=(0,o.useCallback)(()=>e.chain().focus().toggleSubscript().run(),[e]),d=(0,o.useCallback)(()=>e.chain().focus().toggleSuperscript().run(),[e]),c=(0,o.useCallback)(()=>e.chain().focus().setTextAlign("left").run(),[e]),u=(0,o.useCallback)(()=>e.chain().focus().setTextAlign("center").run(),[e]),m=(0,o.useCallback)(()=>e.chain().focus().setTextAlign("right").run(),[e]),p=(0,o.useCallback)(()=>e.chain().focus().setTextAlign("justify").run(),[e]),h=(0,o.useCallback)(t=>e.chain().setColor(t).run(),[e]),g=(0,o.useCallback)(()=>e.chain().focus().unsetColor().run(),[e]),f=(0,o.useCallback)(t=>e.chain().setHighlight({color:t}).run(),[e]),x=(0,o.useCallback)(()=>e.chain().focus().unsetHighlight().run(),[e]),b=(0,o.useCallback)((t,n)=>e.chain().focus().setLink({href:t,target:n?"_blank":""}).run(),[e]);return{onBold:t,onItalic:n,onStrike:a,onUnderline:r,onCode:l,onCodeBlock:i,onSubscript:s,onSuperscript:d,onAlignLeft:c,onAlignCenter:u,onAlignRight:m,onAlignJustify:p,onChangeColor:h,onClearColor:g,onChangeHighlight:f,onClearHighlight:x,onSetFont:(0,o.useCallback)(t=>t&&0!==t.length?e.chain().focus().setFontFamily(t).run():e.chain().focus().unsetFontFamily().run(),[e]),onSetFontSize:(0,o.useCallback)(t=>t&&0!==t.length?e.chain().focus().setFontSize(t).run():e.chain().focus().unsetFontSize().run(),[e]),onLink:b}},q=e=>(0,o.useMemo)(()=>[{type:"category",label:"层级",id:"hierarchy"},{icon:"Pilcrow",onClick:()=>e.chain().focus().lift("taskItem").liftListItem("listItem").setParagraph().run(),id:"paragraph",disabled:()=>!e.can().setParagraph(),isActive:()=>e.isActive("paragraph")&&!e.isActive("orderedList")&&!e.isActive("bulletList")&&!e.isActive("taskList"),label:"段落",type:"option"},{icon:"Heading1",onClick:()=>e.chain().focus().lift("taskItem").liftListItem("listItem").setHeading({level:1}).run(),id:"heading1",disabled:()=>!e.can().setHeading({level:1}),isActive:()=>e.isActive("heading",{level:1}),label:"标题 1",type:"option"},{icon:"Heading2",onClick:()=>e.chain().focus().lift("taskItem").liftListItem("listItem").setHeading({level:2}).run(),id:"heading2",disabled:()=>!e.can().setHeading({level:2}),isActive:()=>e.isActive("heading",{level:2}),label:"标题 2",type:"option"},{icon:"Heading3",onClick:()=>e.chain().focus().lift("taskItem").liftListItem("listItem").setHeading({level:3}).run(),id:"heading3",disabled:()=>!e.can().setHeading({level:3}),isActive:()=>e.isActive("heading",{level:3}),label:"标题 3",type:"option"},{type:"category",label:"列表",id:"lists"},{icon:"List",onClick:()=>e.chain().focus().toggleBulletList().run(),id:"bulletList",disabled:()=>!e.can().toggleBulletList(),isActive:()=>e.isActive("bulletList"),label:"无序列表",type:"option"},{icon:"ListOrdered",onClick:()=>e.chain().focus().toggleOrderedList().run(),id:"orderedList",disabled:()=>!e.can().toggleOrderedList(),isActive:()=>e.isActive("orderedList"),label:"有序列表",type:"option"},{icon:"ListTodo",onClick:()=>e.chain().focus().toggleTaskList().run(),id:"todoList",disabled:()=>!e.can().toggleTaskList(),isActive:()=>e.isActive("taskList"),label:"任务列表",type:"option"}],[e,e.state]),U=(e,t)=>{let{view:n,state:{selection:{from:a}}}=e,r=document.querySelectorAll(".has-focus"),l=r.length,i=r[l-1];if(i&&i.getAttribute("data-type")&&i.getAttribute("data-type")===t||i&&i.classList&&i.classList.contains(t))return i;let o=n.domAtPos(a).node,s=o;for(s.tagName||(s=o.parentElement);s&&!(s.getAttribute("data-type")&&s.getAttribute("data-type")===t)&&!s.classList.contains(t);)s=s.parentElement;return s};var W=n(92665),Z=n(71190),V=n(72504),G=n(78234),X=n(5172),K=n(65318),J=n(13694),Y=n(70570),Q=n(26147),ee=n(24475),et=n(2377),en=n(4e3),ea=n(44342),er=n(18702),el=n(53971);n(85816);var ei=n(40666);n(87687),n(36320);var eo=n(64313),es=n(48904),ed=n(31177),ec=n(94725),eu=n(17213),em=n(79006);let ep=ec.hj.create({name:"selection",addProseMirrorPlugins(){let{editor:e}=this;return[new eu.Sy({key:new eu.H$("selection"),props:{decorations:t=>t.selection.empty||!0===e.isFocused?null:em.EH.create(t.doc,[em.p.inline(t.selection.from,t.selection.to,{class:"selection"})])}})]}});var eh=n(49360),eg=n(75186),ef=n(54887);let ex=e=>{let{label:t}=e;return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 rounded-lg bg-black p-4 text-white shadow-2xl dark:bg-white dark:text-black",children:[(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"size-8 animate-spin",children:(0,i.jsx)("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),t&&(0,i.jsx)("p",{className:"text-sm font-semibold leading-tight text-white dark:text-black",children:t})]})},eb=e=>{let{hasOverlay:t=!0,label:n}=e;return t?(0,ef.createPortal)((0,i.jsx)("div",{className:"fixed left-0 top-0 z-[9999] flex size-full select-none items-center justify-center bg-black/60",children:(0,i.jsx)(ex,{label:n})}),document.body):(0,i.jsx)(ex,{label:n})};var ev=n(37053);let ey=(0,o.forwardRef)((e,t)=>{let{asChild:n,className:a,children:r,spacing:l,noShadow:o,...s}=e,d=(0,u.cn)("p-2","small"===l&&"p-[0.2rem]",a),c=n?ev.g7:"div";return(0,i.jsx)(c,{ref:t,...s,children:(0,i.jsx)(p,{className:d,withShadow:!o,children:r})})});ey.displayName="Panel",(0,o.forwardRef)((e,t)=>{let{asChild:n,className:a,children:r,...l}=e,o=(0,u.cn)("mb-2 border-b border-b-black/10 pb-2",a),s=n?ev.g7:"div";return(0,i.jsx)(s,{className:o,...l,ref:t,children:r})}).displayName="PanelDivider",(0,o.forwardRef)((e,t)=>{let{asChild:n,className:a,children:r,...l}=e,o=(0,u.cn)("mb-2 border-b border-b-black/10 pb-2 text-sm",a),s=n?ev.g7:"div";return(0,i.jsx)(s,{className:o,...l,ref:t,children:r})}).displayName="PanelHeader",(0,o.forwardRef)((e,t)=>{let{asChild:n,className:a,children:r,...l}=e,o=(0,u.cn)("mt-4 first:mt-1",a),s=n?ev.g7:"div";return(0,i.jsx)(s,{className:o,...l,ref:t,children:r})}).displayName="PanelSection";let ek=(0,o.forwardRef)((e,t)=>{let{asChild:n,className:a,children:r,...l}=e,o=(0,u.cn)("mb-2 ml-1.5 text-xs font-medium text-black/80 dark:text-white/80",a),s=n?ev.g7:"div";return(0,i.jsx)(s,{className:o,...l,ref:t,children:r})});ek.displayName="PanelHeadline",(0,o.forwardRef)((e,t)=>{let{asChild:n,className:a,children:r,...l}=e,o=(0,u.cn)("mt-2 border-t border-black/10 pt-2 text-sm",a),s=n?ev.g7:"div";return(0,i.jsx)(s,{className:o,...l,ref:t,children:r})}).displayName="PanelFooter";let ej=(0,o.forwardRef)((e,t)=>{let{className:n,...a}=e,r=(0,u.cn)("block h-[4.5rem] w-full rounded-lg border-0 bg-black/5 px-2 py-1 text-sm font-medium text-black caret-black","dark:bg-white/10 dark:text-white dark:caret-white","hover:bg-black/10","dark:hover:bg-white/20","focus:bg-transparent focus:outline focus:outline-black active:bg-transparent active:outline active:outline-black","dark:focus:outline-white dark:active:outline-white",n);return(0,i.jsx)("textarea",{className:r,ref:t,...a})});ej.displayName="Textarea";let ew=e=>{let{editor:t,node:n,getPos:a,deleteNode:r}=e,l=t.extensionManager.extensions.find(e=>"ai"===e.name).options,[s,c]=(0,o.useState)({text:"",tone:void 0,textLength:void 0,addHeading:!1,language:void 0}),u=S.find(e=>e.value===s.tone),[g,f]=(0,o.useState)(void 0),[x,b]=(0,o.useState)(!1),v=(0,o.useMemo)(()=>(0,eh.Z)(),[]),y=(0,o.useCallback)(async()=>{let{text:e,tone:t,textLength:n,textUnit:a,addHeading:r,language:i}=s;if(!s.text){eg.ZP.error("Please enter a description");return}b(!0);try{let{baseUrl:o,appId:s,token:d}=l,c=await fetch("".concat(o,"/text/prompt"),{method:"POST",headers:{accept:"application.json","Content-Type":"application/json","X-App-Id":s.trim(),Authorization:"Bearer ".concat(d.trim())},body:JSON.stringify({text:e,textLength:n,textUnit:a,useHeading:r,tone:t,language:i})}),u=(await c.json()).response;if(!u.length){b(!1);return}f(u),b(!1)}catch(t){var o,d;let e=null==t?void 0:null===(d=t.response)||void 0===d?void 0:null===(o=d.data)||void 0===o?void 0:o.error;b(!1),eg.ZP.error("An error occurred"!==e?"An error has occured: ".concat(e):e)}},[s,l]),k=(0,o.useCallback)(()=>{let e=a(),r=e+n.nodeSize;t.chain().focus().insertContentAt({from:e,to:r},g).run()},[t,g,a,n.nodeSize]),w=(0,o.useCallback)(()=>{r()},[r]),C=(0,o.useCallback)(e=>{c(t=>({...t,text:e.target.value}))},[]),N=(0,o.useCallback)(()=>{c(e=>({...e,tone:void 0}))},[]),A=(0,o.useCallback)(e=>()=>{c(t=>({...t,tone:e.value}))},[]);return(0,i.jsx)(d.T5,{"data-drag-handle":!0,children:(0,i.jsx)(ey,{noShadow:!0,className:"w-full",children:(0,i.jsxs)("div",{className:"flex flex-col p-1",children:[x&&(0,i.jsx)(eb,{label:"AI is now doing its job!"}),g&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ek,{children:"Preview"}),(0,i.jsx)("div",{className:"relative mb-4 ml-2.5 max-h-[14rem] overflow-y-auto border-l-4 border-neutral-100 bg-white px-4 text-base text-black dark:border-neutral-700 dark:bg-black dark:text-white",dangerouslySetInnerHTML:{__html:g}})]}),(0,i.jsx)("div",{className:"flex flex-row items-center justify-between gap-1",children:(0,i.jsx)(ek,{asChild:!0,children:(0,i.jsx)("label",{htmlFor:v,children:"Prompt"})})}),(0,i.jsx)(ej,{id:v,value:s.text,onChange:C,placeholder:"Tell me what you want me to write about.",required:!0,className:"mb-2"}),(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between gap-1",children:[(0,i.jsx)("div",{className:"flex w-auto justify-between gap-1",children:(0,i.jsxs)(I.fC,{children:[(0,i.jsx)(I.xz,{asChild:!0,children:(0,i.jsxs)(h,{variant:"tertiary",children:[(0,i.jsx)(m,{name:"Mic"}),(null==u?void 0:u.label)||"Change tone",(0,i.jsx)(m,{name:"ChevronDown"})]})}),(0,i.jsx)(I.Uv,{children:(0,i.jsx)(I.VY,{side:"bottom",align:"start",asChild:!0,children:(0,i.jsxs)(p,{className:"min-w-[12rem] p-2",children:[!!s.tone&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(I.ck,{asChild:!0,children:(0,i.jsxs)(_,{isActive:void 0===s.tone,onClick:N,children:[(0,i.jsx)(m,{name:"Undo2"}),"Reset"]})}),(0,i.jsx)(j.Divider,{horizontal:!0})]}),S.map(e=>(0,i.jsx)(I.ck,{asChild:!0,children:(0,i.jsx)(_,{isActive:e.value===s.tone,onClick:A(e),children:e.label})},e.value))]})})})]})}),(0,i.jsxs)("div",{className:"flex w-auto justify-between gap-1",children:[g&&(0,i.jsxs)(h,{variant:"ghost",className:"text-red-500 hover:bg-red-500/10 hover:text-red-500",onClick:w,children:[(0,i.jsx)(m,{name:"Trash"}),"Discard"]}),g&&(0,i.jsxs)(h,{variant:"ghost",onClick:k,disabled:!g,children:[(0,i.jsx)(m,{name:"Check"}),"Insert"]}),(0,i.jsxs)(h,{variant:"primary",onClick:y,style:{whiteSpace:"nowrap"},children:[g?(0,i.jsx)(m,{name:"Repeat"}):(0,i.jsx)(m,{name:"Sparkles"}),g?"Regenerate":"Generate text"]})]})]})]})})})},eC=ec.NB.create({name:"aiWriter",group:"block",draggable:!0,addOptions(){return{authorId:void 0,authorName:void 0,HTMLAttributes:{class:"node-".concat(this.name)}}},addAttributes:()=>({id:{default:void 0,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>({"data-id":e.id})},authorId:{default:void 0,parseHTML:e=>e.getAttribute("data-author-id"),renderHTML:e=>({"data-author-id":e.authorId})},authorName:{default:void 0,parseHTML:e=>e.getAttribute("data-author-name"),renderHTML:e=>({"data-author-name":e.authorName})}}),parseHTML(){return[{tag:"div.node-".concat(this.name)}]},renderHTML(e){let{HTMLAttributes:t}=e;return["div",(0,ec.P1)(this.options.HTMLAttributes,t)]},addCommands(){return{setAiWriter:()=>e=>{let{chain:t}=e;return t().focus().insertContent({type:this.name,attrs:{id:(0,eh.Z)(),authorId:this.options.authorId,authorName:this.options.authorName}}).run()}}},addNodeView:()=>(0,d.fW)(ew)}),eN=[{name:"photorealistic",label:"Photorealistic",value:"photorealistic"},{name:"digital-art",label:"Digital art",value:"digital_art"},{name:"comic-book",label:"Comic book",value:"comic_book"},{name:"neon-punk",label:"Neon punk",value:"neon_punk"},{name:"isometric",label:"Isometric",value:"isometric"},{name:"line-art",label:"Line art",value:"line_art"},{name:"3d-model",label:"3D model",value:"3d_model"}],eS=e=>{let{editor:t,node:n,getPos:a,deleteNode:r}=e,l=t.extensionManager.extensions.find(e=>"ai"===e.name).options,[s,c]=(0,o.useState)({text:"",imageStyle:void 0}),u=eN.find(e=>e.value===s.imageStyle),[g,f]=(0,o.useState)(void 0),[x,b]=(0,o.useState)(!1),v=(0,o.useMemo)(()=>(0,eh.Z)(),[]),y=(0,o.useCallback)(async()=>{if(!s.text){eg.ZP.error("Please enter a description for the image");return}b(!0);let e={text:s.text,style:s.imageStyle};try{let{baseUrl:t,appId:n,token:a}=l,r=await fetch("".concat(t,"/image/prompt"),{method:"POST",headers:{accept:"application.json","Content-Type":"application/json","X-App-Id":n.trim(),Authorization:"Bearer ".concat(a.trim())},body:JSON.stringify(e)}),i=(await r.json()).response;if(!i.length)return;f(i),b(!1)}catch(a){var t,n;let e=null==a?void 0:null===(n=a.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.error;b(!1),eg.ZP.error("An error occurred"!==e?"An error has occured: ".concat(e):e)}},[s,l]),k=(0,o.useCallback)(()=>{(null==g?void 0:g.length)&&(t.chain().insertContent('<img src="'.concat(g,'" alt="" />')).deleteRange({from:a(),to:a()}).focus().run(),b(!1))},[t,g,a]),w=(0,o.useCallback)(()=>{r()},[r]),C=(0,o.useCallback)(e=>c(t=>({...t,text:e.target.value})),[]),N=(0,o.useCallback)(()=>{c(e=>({...e,imageStyle:void 0})),f(void 0)},[]),S=(0,o.useCallback)(e=>()=>c(t=>({...t,imageStyle:e.value})),[]);return(0,i.jsx)(d.T5,{"data-drag-handle":!0,children:(0,i.jsx)(ey,{noShadow:!0,className:"w-full",children:(0,i.jsxs)("div",{className:"flex flex-col p-1",children:[x&&(0,i.jsx)(eb,{label:"AI is now doing its job!"}),g&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ek,{children:"Preview"}),(0,i.jsx)("div",{className:"mb-4 aspect-square w-full rounded border border-black bg-white bg-contain bg-center bg-no-repeat dark:border-neutral-700",style:{backgroundImage:"url(".concat(g,")")}})]}),(0,i.jsx)("div",{className:"row flex items-center justify-between gap-2",children:(0,i.jsx)(ek,{asChild:!0,children:(0,i.jsx)("label",{htmlFor:v,children:"Prompt"})})}),(0,i.jsx)(ej,{id:v,value:s.text,onChange:C,placeholder:"Describe the image that you want me to generate.",required:!0,className:"mb-2"}),(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between gap-1",children:[(0,i.jsx)("div",{className:"flex w-auto justify-between gap-1",children:(0,i.jsxs)(I.fC,{children:[(0,i.jsx)(I.xz,{asChild:!0,children:(0,i.jsxs)(h,{variant:"tertiary",children:[(0,i.jsx)(m,{name:"Image"}),(null==u?void 0:u.label)||"Image style",(0,i.jsx)(m,{name:"ChevronDown"})]})}),(0,i.jsx)(I.Uv,{children:(0,i.jsx)(I.VY,{side:"bottom",align:"start",asChild:!0,children:(0,i.jsxs)(p,{className:"min-w-[12rem] p-2",children:[!!s.imageStyle&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(_,{isActive:void 0===s.imageStyle,onClick:N,children:[(0,i.jsx)(m,{name:"Undo2"}),"Reset"]}),(0,i.jsx)(j.Divider,{horizontal:!0})]}),eN.map(e=>(0,i.jsx)(_,{isActive:e.value===s.imageStyle,onClick:S(e),children:e.label},e.value))]})})})]})}),(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between gap-1",children:[g&&(0,i.jsxs)(h,{variant:"ghost",className:"text-red-500 hover:bg-red-500/10 hover:text-red-500",onClick:w,children:[(0,i.jsx)(m,{name:"Trash"}),"Discard"]}),g&&(0,i.jsxs)(h,{variant:"ghost",onClick:k,children:[(0,i.jsx)(m,{name:"Check"}),"Insert"]}),(0,i.jsxs)(h,{variant:"primary",onClick:y,children:[g?(0,i.jsx)(m,{name:"Repeat"}):(0,i.jsx)(m,{name:"Sparkles"}),g?"Regenerate":"Generate image"]})]})]})]})})})},eA=ec.NB.create({name:"aiImage",group:"block",draggable:!0,addOptions(){return{authorId:void 0,authorName:void 0,HTMLAttributes:{class:"node-".concat(this.name)}}},addAttributes:()=>({id:{default:void 0,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>({"data-id":e.id})},authorId:{default:void 0,parseHTML:e=>e.getAttribute("data-author-id"),renderHTML:e=>({"data-author-id":e.authorId})},authorName:{default:void 0,parseHTML:e=>e.getAttribute("data-author-name"),renderHTML:e=>({"data-author-name":e.authorName})}}),parseHTML(){return[{tag:"div.node-".concat(this.name)}]},renderHTML(e){let{HTMLAttributes:t}=e;return["div",(0,ec.P1)(this.options.HTMLAttributes,t)]},addCommands(){return{setAiImage:()=>e=>{let{chain:t}=e;return t().focus().insertContent({type:this.name,attrs:{id:(0,eh.Z)(),authorId:this.options.authorId,authorName:this.options.authorName}}).run()}}},addNodeView:()=>(0,d.fW)(eS)}),eL=n(27644).ZP.configure({resizable:!0,lastColumnResizable:!1});var eT=n(57958);let eP=e=>t=>{let n=eT.rU.get(t.$anchorCell.node(-1)),a=t.$anchorCell.start(-1),r=n.cellsInRect(e),l=n.cellsInRect(n.rectBetween(t.$anchorCell.pos-a,t.$headCell.pos-a));for(let e=0,t=r.length;e<t;e+=1)if(-1===l.indexOf(r[e]))return!1;return!0},eM=e=>(0,ec.Kk)(e=>e.type.spec.tableRole&&"table"===e.type.spec.tableRole)(e),eH=e=>e instanceof eT.Xc,eI=e=>t=>!!eH(t)&&eP({left:e,right:e+1,top:0,bottom:eT.rU.get(t.$anchorCell.node(-1)).height})(t),eB=e=>t=>!!eH(t)&&eP({left:0,right:eT.rU.get(t.$anchorCell.node(-1)).width,top:e,bottom:e+1})(t),e_=e=>{if(eH(e)){let t=eT.rU.get(e.$anchorCell.node(-1));return eP({left:0,right:t.width,top:0,bottom:t.height})(e)}return!1},ez=e=>t=>{let n=eM(t);if(n){let t=eT.rU.get(n.node);return(Array.isArray(e)?e:Array.from([e])).reduce((e,a)=>{if(a>=0&&a<=t.width-1){let r=t.cellsInRect({left:a,right:a+1,top:0,bottom:t.height});return e.concat(r.map(e=>{let t=n.node.nodeAt(e),a=e+n.start;return{pos:a,start:a+1,node:t}}))}return e},[])}return null},eR=e=>t=>{let n=eM(t);if(n){let t=eT.rU.get(n.node);return(Array.isArray(e)?e:Array.from([e])).reduce((e,a)=>{if(a>=0&&a<=t.height-1){let r=t.cellsInRect({left:0,right:t.width,top:a,bottom:a+1});return e.concat(r.map(e=>{let t=n.node.nodeAt(e),a=e+n.start;return{pos:a,start:a+1,node:t}}))}return e},[])}return null},eE=e=>t=>n=>{let a=eM(n.selection),r="row"===e;if(a){let e=eT.rU.get(a.node);if(t>=0&&t<(r?e.height:e.width)){let l=r?0:t,i=r?t:0,o=r?e.width:t+1,s=r?t+1:e.height,d=e.cellsInRect({left:l,top:i,right:r?o:l+1,bottom:r?i+1:s}),c=s-i==1?d:e.cellsInRect({left:r?l:o-1,top:r?s-1:i,right:o,bottom:s}),u=a.start+d[0],m=a.start+c[c.length-1],p=n.doc.resolve(u),h=n.doc.resolve(m);return n.setSelection(new eT.Xc(h,p))}}return n},eD=eE("column"),e$=eE("row"),eO=ec.NB.create({name:"tableCell",content:"block+",tableRole:"cell",isolating:!0,addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"td"}],renderHTML(e){let{HTMLAttributes:t}=e;return["td",(0,ec.P1)(this.options.HTMLAttributes,t),0]},addAttributes:()=>({colspan:{default:1,parseHTML:e=>{let t=e.getAttribute("colspan");return t?parseInt(t,10):1}},rowspan:{default:1,parseHTML:e=>{let t=e.getAttribute("rowspan");return t?parseInt(t,10):1}},colwidth:{default:null,parseHTML:e=>{let t=e.getAttribute("colwidth");return t?[parseInt(t,10)]:null}},style:{default:null}}),addProseMirrorPlugins(){let{isEditable:e}=this.editor;return[new eu.Sy({props:{decorations:t=>{if(!e)return em.EH.empty;let{doc:n,selection:a}=t,r=[],l=ez(0)(a);return l&&l.forEach((e,t)=>{let{pos:n}=e;r.push(em.p.widget(n+1,()=>{let e=eB(t)(a),n="grip-row";e&&(n+=" selected"),0===t&&(n+=" first"),t===l.length-1&&(n+=" last");let r=document.createElement("a");return r.className=n,r.addEventListener("mousedown",e=>{e.preventDefault(),e.stopImmediatePropagation(),this.editor.view.dispatch(e$(t)(this.editor.state.tr))}),r}))}),em.EH.create(n,r)}}})]}}),eF=n(84110).Z.extend({allowGapCursor:!1,content:"tableCell*"}),eq=n(67966).Z.extend({addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{let t=e.getAttribute("colwidth");return t?t.split(",").map(e=>parseInt(e,10)):null}},style:{default:null}}),addProseMirrorPlugins(){let{isEditable:e}=this.editor;return[new eu.Sy({props:{decorations:t=>{if(!e)return em.EH.empty;let{doc:n,selection:a}=t,r=[],l=eR(0)(a);return l&&l.forEach((e,t)=>{let{pos:n}=e;r.push(em.p.widget(n+1,()=>{let e=eI(t)(a),n="grip-column";e&&(n+=" selected"),0===t&&(n+=" first"),t===l.length-1&&(n+=" last");let r=document.createElement("a");return r.className=n,r.addEventListener("mousedown",e=>{e.preventDefault(),e.stopImmediatePropagation(),this.editor.view.dispatch(eD(t)(this.editor.state.tr))}),r}))}),em.EH.create(n,r)}}})]}}),eU=n(72691).Z.extend({renderHTML(){return["div",(0,ec.P1)(this.options.HTMLAttributes,{"data-type":this.name}),["hr"]]}}),eW=n(11670).Z.extend({renderHTML(e){let{node:t,HTMLAttributes:n}=e,a=parseInt(t.attrs.level,10),r=this.options.levels.includes(a)?a:this.options.levels[0];return["h".concat(r),(0,ec.P1)(this.options.HTMLAttributes,n),0]}}),eZ=n(28098).B.extend({content:"(block|columns)+"});function eV(e){let{types:t,node:n}=e;return Array.isArray(t)&&t.includes(n.type)||n.type===t}let eG=ec.hj.create({name:"trailingNode",addOptions:()=>({node:"paragraph",notAfter:["paragraph"]}),addProseMirrorPlugins(){let e=new eu.H$(this.name),t=Object.entries(this.editor.schema.nodes).map(e=>{let[,t]=e;return t}).filter(e=>this.options.notAfter.includes(e.name));return[new eu.Sy({key:e,appendTransaction:(t,n,a)=>{let{doc:r,tr:l,schema:i}=a,o=e.getState(a),s=r.content.size,d=i.nodes[this.options.node];if(o)return l.insert(s,d.create())},state:{init:(e,n)=>!eV({node:n.tr.doc.lastChild,types:t}),apply:(e,n)=>e.docChanged?!eV({node:e.doc.lastChild,types:t}):n}})]}});var eX=n(20075),eK=n(34361);let eJ=[{name:"format",title:"格式",commands:[{name:"heading1",label:"标题 1",iconName:"Heading1",description:"High priority section title",aliases:["h1"],action:e=>{e.chain().focus().setHeading({level:1}).run()}},{name:"heading2",label:"标题 2",iconName:"Heading2",description:"Medium priority section title",aliases:["h2"],action:e=>{e.chain().focus().setHeading({level:2}).run()}},{name:"heading3",label:"标题 3",iconName:"Heading3",description:"Low priority section title",aliases:["h3"],action:e=>{e.chain().focus().setHeading({level:3}).run()}},{name:"bulletList",label:"无序列表（Bullet List）",iconName:"List",description:"Unordered list of items",aliases:["ul"],action:e=>{e.chain().focus().toggleBulletList().run()}},{name:"numberedList",label:"有序列表（Numbered List）",iconName:"ListOrdered",description:"Ordered list of items",aliases:["ol"],action:e=>{e.chain().focus().toggleOrderedList().run()}},{name:"taskList",label:"任务列表（Task List）",iconName:"ListTodo",description:"Task list with todo items",aliases:["todo"],action:e=>{e.chain().focus().toggleTaskList().run()}},{name:"blockquote",label:"引用块（Blockquote）",iconName:"Quote",description:"Element for quoting",action:e=>{e.chain().focus().setBlockquote().run()}},{name:"codeBlock",label:"代码块（Code Block）",iconName:"CodeXml",description:"Code block with syntax highlighting",shouldBeHidden:e=>e.isActive("columns"),action:e=>{e.chain().focus().setCodeBlock().run()}}]},{name:"insert",title:"插入",commands:[{name:"table",label:"表格（Table）",iconName:"Table",description:"Insert a table",shouldBeHidden:e=>e.isActive("columns"),action:e=>{e.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!1}).run()}},{name:"image",label:"图片（Image）",iconName:"Image",description:"Insert an image",aliases:["img"],action:e=>{e.chain().focus().setImageUpload().run()}},{name:"video",label:"视频（Video）",iconName:"Video",description:"Insert an Video",aliases:["iframe"],action:e=>{let t=prompt("输入视频内嵌代码");if(!t)return;let n=t.match(/src=["']?([^"'>\s]+)["']?/i);n&&e.chain().focus().setVideoCode({src:n[1]}).run()}},{name:"columns",label:"两列（Columns）",iconName:"Columns2",description:"Add two column content",aliases:["cols"],shouldBeHidden:e=>e.isActive("columns"),action:e=>{e.chain().focus().setColumns().focus(e.state.selection.head-1).run()}},{name:"horizontalRule",label:"水平线（Horizontal）",iconName:"Minus",description:"Insert a horizontal divider",aliases:["hr"],action:e=>{e.chain().focus().setHorizontalRule().run()}},{name:"toc",label:"目录（Table of Contents）",iconName:"Book",aliases:["outline"],description:"Insert a table of contents",shouldBeHidden:e=>e.isActive("columns"),action:e=>{e.chain().focus().insertTableOfContents().run()}}]}],eY=o.forwardRef((e,t)=>{let n=(0,o.useRef)(null),a=(0,o.useRef)(null),[r,l]=(0,o.useState)(0),[s,d]=(0,o.useState)(0);(0,o.useEffect)(()=>{l(0),d(0)},[e.items]);let c=(0,o.useCallback)((t,n)=>{let a=e.items[t].commands[n];e.command(a)},[e]);o.useImperativeHandle(t,()=>({onKeyDown:t=>{let{event:n}=t;if("ArrowDown"===n.key){if(!e.items.length)return!1;let t=e.items[r].commands,n=s+1,a=r;return t.length-1<n&&(n=0,a=r+1),e.items.length-1<a&&(a=0),d(n),l(a),!0}if("ArrowUp"===n.key){if(!e.items.length)return!1;let t=s-1,n=r;if(t<0){var a;n=r-1,t=(null===(a=e.items[n])||void 0===a?void 0:a.commands.length)-1||0}return n<0&&(n=e.items.length-1,t=e.items[n].commands.length-1),d(t),l(n),!0}return"Enter"===n.key&&!!e.items.length&&-1!==r&&-1!==s&&(c(r,s),!0)}})),(0,o.useEffect)(()=>{if(a.current&&n.current){let e=a.current.offsetTop,t=a.current.offsetHeight;n.current.scrollTop=e-t}},[s,r]);let u=(0,o.useCallback)((e,t)=>()=>{c(e,t)},[c]);return e.items.length?(0,i.jsx)(p,{ref:n,className:"mb-8 max-h-[min(80vh,24rem)] flex-wrap overflow-auto p-2 text-black",children:(0,i.jsx)("div",{className:"grid grid-cols-1 gap-0.5",children:e.items.map((e,t)=>(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("div",{className:"col-start-1 col-end-1 mx-2 mt-4 select-none text-[0.65rem] font-semibold uppercase tracking-wider text-neutral-500 first:mt-0.5",children:e.title},"".concat(e.title)),e.commands.map((e,n)=>(0,i.jsxs)(_,{isActive:r===t&&s===n,onClick:u(t,n),children:[(0,i.jsx)(m,{name:e.iconName,className:"mr-1"}),e.label]},"".concat(e.label)))]},"".concat(e.title,"-wrapper")))})}):null});eY.displayName="MenuList";let eQ="slashCommand",e0=ec.hj.create({name:eQ,priority:200,onCreate(){a=(0,eK.ZP)("body",{interactive:!0,trigger:"manual",placement:"bottom-start",theme:"slash-command",maxWidth:"16rem",offset:[16,8],popperOptions:{strategy:"fixed",modifiers:[{name:"flip",enabled:!1}]}})},addProseMirrorPlugins(){return[(0,eX.ZP)({editor:this.editor,char:"/",allowSpaces:!0,startOfLine:!0,pluginKey:new eu.H$(eQ),allow:e=>{var t,n,a;let{state:r,range:l}=e,i=r.doc.resolve(l.from),o=1===i.depth,s="paragraph"===i.parent.type.name,d=(null===(t=i.parent.textContent)||void 0===t?void 0:t.charAt(0))==="/",c=this.editor.isActive("column"),u=null===(a=i.parent.textContent)||void 0===a?void 0:a.substring(null===(n=i.parent.textContent)||void 0===n?void 0:n.indexOf("/")),m=!(null==u?void 0:u.endsWith("  "));return(o&&s&&d||c&&s&&d)&&m},command:e=>{var t,n,a;let{editor:r,props:l}=e,{view:i,state:o}=r,{$head:s,$from:d}=i.state.selection,c=d.pos,u=(null==s?void 0:s.nodeBefore)?c-(null!==(a=null===(n=s.nodeBefore.text)||void 0===n?void 0:n.substring(null===(t=s.nodeBefore.text)||void 0===t?void 0:t.indexOf("/")).length)&&void 0!==a?a:0):d.start(),m=o.tr.deleteRange(u,c);i.dispatch(m),l.action(r),i.focus()},items:e=>{let{query:t}=e;return eJ.map(e=>({...e,commands:e.commands.filter(e=>{let n=e.label.toLowerCase().trim(),a=t.toLowerCase().trim();if(e.aliases){let t=e.aliases.map(e=>e.toLowerCase().trim());return n.includes(a)||t.includes(a)}return n.includes(a)}).filter(e=>!e.shouldBeHidden||!e.shouldBeHidden(this.editor))})).filter(e=>e.commands.length>0).map(e=>({...e,commands:e.commands.map(e=>({...e,isEnabled:!0}))}))},render:()=>{let e;let t=null;return{onStart:n=>{var r;e=new d.M_(eY,{props:n,editor:n.editor});let{view:l}=n.editor,i=l.dom,o=()=>{if(!n.clientRect)return n.editor.storage[eQ].rect;let t=n.clientRect();if(!t)return n.editor.storage[eQ].rect;let a=t.y;if(t.top+e.element.offsetHeight+40>window.innerHeight){let n=t.top+e.element.offsetHeight-window.innerHeight+40;a=t.y-n}return i.getBoundingClientRect().x,new DOMRect(t.x,a,t.width,t.height)};t=()=>{null==a||a[0].setProps({getReferenceClientRect:o})},null===(r=l.dom.parentElement)||void 0===r||r.addEventListener("scroll",t),null==a||a[0].setProps({getReferenceClientRect:o,appendTo:()=>document.body,content:e.element}),null==a||a[0].show()},onUpdate(t){var n;e.updateProps(t);let{view:r}=t.editor;r.dom;let l=()=>{if(!t.clientRect)return t.editor.storage[eQ].rect;let e=t.clientRect();return e?new DOMRect(e.x,e.y,e.width,e.height):t.editor.storage[eQ].rect};null===(n=r.dom.parentElement)||void 0===n||n.addEventListener("scroll",()=>{null==a||a[0].setProps({getReferenceClientRect:l})}),t.editor.storage[eQ].rect=t.clientRect?l():{width:0,height:0,left:0,top:0,right:0,bottom:0},null==a||a[0].setProps({getReferenceClientRect:l})},onKeyDown(t){var n;return"Escape"===t.event.key?(null==a||a[0].hide(),!0):((null==a?void 0:a[0].state.isShown)||null==a||a[0].show(),null===(n=e.ref)||void 0===n?void 0:n.onKeyDown(t))},onExit(n){if(null==a||a[0].hide(),t){var r;let{view:e}=n.editor;null===(r=e.dom.parentElement)||void 0===r||r.removeEventListener("scroll",t)}e.destroy()}}}})]},addStorage:()=>({rect:{width:0,height:0,left:0,top:0,right:0,bottom:0}})}),e1=ec.hj.create({name:"fontSize",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:["paragraph"],attributes:{class:{}}},{types:this.options.types,attributes:{fontSize:{parseHTML:e=>e.style.fontSize.replace(/['"]+/g,""),renderHTML:e=>e.fontSize?{style:"font-size: ".concat(e.fontSize)}:{}}}}]},addCommands:()=>({setFontSize:e=>t=>{let{chain:n}=t;return n().setMark("textStyle",{fontSize:e}).run()},unsetFontSize:()=>e=>{let{chain:t}=e;return t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}})}),e2=ec.NB.create({name:"figure",addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"block figcaption",draggable:!0,defining:!0,selectable:!0,parseHTML(){return[{tag:'figure[data-type="'.concat(this.name,'"]')}]},renderHTML(e){let{HTMLAttributes:t}=e;return["figure",(0,ec.P1)(t,{"data-type":this.name}),0]},addProseMirrorPlugins(){return[new eu.Sy({props:{handleDOMEvents:{dragstart:(e,t)=>{if(!t.target)return!1;let n=e.posAtDOM(t.target,0);return e.state.doc.resolve(n).parent.type.name===this.type.name&&t.preventDefault(),!1}}}})]}});var e5=n(63676);let e9=e5.Ee.extend({group:"block"}),e4=ec.NB.create({name:"figcaption",addOptions:()=>({HTMLAttributes:{}}),content:"inline*",selectable:!1,draggable:!1,marks:"link",parseHTML:()=>[{tag:"figcaption"}],addKeyboardShortcuts(){return{Enter:e=>{let{editor:t}=e,{state:{selection:{$from:n,empty:a}}}=t;if(!a||n.parent.type!==this.type||n.parentOffset!==n.parent.nodeSize-2)return!1;let r=t.state.selection.$from.end();return t.chain().focus(r).insertContentAt(r,{type:"paragraph"}).run()},Backspace:e=>{let{editor:t}=e,{state:{selection:{$from:n,empty:a}}}=t;if(!a||n.parent.type!==this.type||0!==n.parentOffset)return!1;let r=t.state.doc.nodeAt(n.pos-2);return(null==r?void 0:r.type.name)===e9.name}}},renderHTML(e){let{HTMLAttributes:t}=e;return["figcaption",(0,ec.P1)(t),0]}}),e3=ec.NB.create({name:"quote",content:"paragraph+",defining:!0,marks:"",parseHTML:()=>[{tag:"blockquote"}],renderHTML(e){let{HTMLAttributes:t}=e;return["blockquote",t,0]},addKeyboardShortcuts:()=>({Backspace:()=>!1})}),e8=ec.NB.create({name:"quoteCaption",group:"block",content:"text*",defining:!0,isolating:!0,parseHTML:()=>[{tag:"figcaption"}],renderHTML(e){let{HTMLAttributes:t}=e;return["figcaption",t,0]},addKeyboardShortcuts(){return{Enter:e=>{let{editor:t}=e,{state:{selection:{$from:n,empty:a}}}=t;if(!a||n.parent.type!==this.type||n.parentOffset!==n.parent.nodeSize-2)return!1;let r=t.state.selection.$from.end();return t.chain().focus(r).insertContentAt(r,{type:"paragraph"}).run()}}}}),e6=e2.extend({name:"blockquoteFigure",group:"block",content:"quote quoteCaption",isolating:!0,addExtensions:()=>[e3,e8],renderHTML(e){let{HTMLAttributes:t}=e;return["figure",(0,ec.P1)(t,{"data-type":this.name}),["div",{},0]]},addKeyboardShortcuts:()=>({Enter:()=>!1}),addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this)}},addCommands(){return{setBlockquote:()=>e=>{let{state:t,chain:n}=e,a=t.selection.$from.start(),r=t.selection.content();return n().focus().insertContent({type:this.name,content:[{type:"quote",content:r.content.toJSON()||[{type:"paragraph",attrs:{textAlign:"left"}}]},{type:"quoteCaption"}]}).focus(a+1).run()}}}}),e7=n(54816).ZP.extend({inclusive:!1,parseHTML:()=>[{tag:'a[href]:not([data-type="button"]):not([href *= "javascript:" i]:not(:has(img)))'}],renderHTML(e){let{HTMLAttributes:t}=e;return["a",(0,ec.P1)(this.options.HTMLAttributes,t,{class:"link"}),0]},addProseMirrorPlugins(){var e;let{editor:t}=this;return[...(null===(e=this.parent)||void 0===e?void 0:e.call(this))||[],new eu.Sy({props:{handleKeyDown:(e,n)=>{let{selection:a}=t.state;return"Escape"===n.key&&!0!==a.empty&&t.commands.focus(a.to,{scrollIntoView:!1}),!1}}})]}}),te=(0,o.forwardRef)((e,t)=>{let{className:n,...a}=e,r=(0,u.cn)("size-4 animate-spin rounded-full border-2 border-current border-t-transparent",n);return(0,i.jsx)("div",{className:r,ref:t,...a})});te.displayName="Spinner";var tt=n(88972),tn=n(50921),ta=n(49946);let tr=()=>{let[e,{data:t,loading:n}]=(0,tt.D)(tn.uk);return{upload:async t=>(await e({variables:{file:t}})).data.upload,data:t,loading:n}},tl=async e=>{let t=(0,ta.u)();return(await t.mutate({mutation:tn.uk,variables:{file:e}})).data.upload+"?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_d2F0ZXJtYXJrLnBuZz94LW9zcy1wcm9jZXNzPWltYWdlL3Jlc2l6ZSxQXzEy,g_south,t_55,x_1,y_20"},ti=()=>{let[e,{data:t,loading:n}]=(0,tt.D)(tn.NF);return{uploadRemote:async t=>(await e({variables:{url:t}})).data.remoteFile+"?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_d2F0ZXJtYXJrLnBuZz94LW9zcy1wcm9jZXNzPWltYWdlL3Jlc2l6ZSxQXzEy,g_south,t_55,x_1,y_20",data:t,loading:n}},to=e=>{let{onUpload:t}=e,{upload:n,loading:a}=tr();return{loading:a,uploadFile:(0,o.useCallback)(async e=>{t(await n(e))},[t,n])}},ts=()=>{let e=(0,o.useRef)(null),t=(0,o.useCallback)(()=>{var t;null===(t=e.current)||void 0===t||t.click()},[]);return{ref:e,handleUploadClick:t}},td=e=>{let{uploader:t}=e,[n,a]=(0,o.useState)(!1),[r,l]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e=()=>{a(!0)},t=()=>{a(!1)};return document.body.addEventListener("dragstart",e),document.body.addEventListener("dragend",t),()=>{document.body.removeEventListener("dragstart",e),document.body.removeEventListener("dragend",t)}},[]),{isDragging:n,draggedInside:r,onDragEnter:()=>{l(!0)},onDragLeave:()=>{l(!1)},onDrop:(0,o.useCallback)(e=>{if(l(!1),0===e.dataTransfer.files.length)return;let n=e.dataTransfer.files,a=[];for(let e=0;e<n.length;e+=1){let t=n.item(e);t&&a.push(t)}if(a.some(e=>-1===e.type.indexOf("image")))return;e.preventDefault();let r=a.filter(e=>-1!==e.type.indexOf("image")),i=r.length>0?r[0]:void 0;i&&t(i)},[t])}},tc=e=>{let{onUpload:t}=e,{loading:n,uploadFile:a}=to({onUpload:t}),{handleUploadClick:r,ref:l}=ts(),{draggedInside:s,onDrop:d,onDragEnter:c,onDragLeave:p}=td({uploader:a}),g=(0,o.useCallback)(e=>e.target.files?a(e.target.files[0]):null,[a]);if(n)return(0,i.jsx)("div",{className:"flex min-h-[10rem] items-center justify-center rounded-lg bg-white/80 p-8",children:(0,i.jsx)(te,{className:"text-neutral-500",size:1.5})});let f=(0,u.cn)("flex flex-col items-center justify-center rounded-lg bg-white/80 px-8 py-10",s&&"bg-neutral-100");return(0,i.jsxs)("div",{className:f,onDrop:d,onDragOver:c,onDragLeave:p,contentEditable:!1,children:[(0,i.jsx)(m,{name:"Image",className:"mb-4 size-12 text-black opacity-20 dark:text-white"}),(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,i.jsx)("div",{className:"text-center text-sm font-medium text-neutral-400 dark:text-neutral-500",children:s?"将图像拖放到此处":"将图像拖放到此处或"}),(0,i.jsx)("div",{children:(0,i.jsxs)(h,{disabled:s,onClick:r,variant:"primary",buttonSize:"small",children:[(0,i.jsx)(m,{name:"Upload"}),"选择上传图片"]})})]}),(0,i.jsx)("input",{className:"size-0 overflow-hidden opacity-0",ref:l,type:"file",accept:".jpg,.jpeg,.png,.webp,.gif",onChange:g})]})},tu=e=>{let{getPos:t,editor:n}=e,a=(0,o.useCallback)(e=>{e&&n.chain().setImageBlock({src:e+"?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_d2F0ZXJtYXJrLnBuZz94LW9zcy1wcm9jZXNzPWltYWdlL3Jlc2l6ZSxQXzEy,g_south,t_55,x_1,y_20"}).deleteRange({from:t(),to:t()}).focus().run()},[t,n]);return(0,i.jsx)(d.T5,{children:(0,i.jsx)("div",{className:"m-0 p-0","data-drag-handle":!0,children:(0,i.jsx)(tc,{onUpload:a})})})},tm=ec.NB.create({name:"imageUpload",isolating:!0,defining:!0,group:"block",draggable:!0,selectable:!0,inline:!1,parseHTML(){return[{tag:'div[data-type="'.concat(this.name,'"]')}]},renderHTML(){return["div",{"data-type":this.name}]},addCommands(){return{setImageUpload:()=>e=>{let{commands:t}=e;return t.insertContent('<div data-type="'.concat(this.name,'"></div>'))}}},addNodeView:()=>(0,d.fW)(tu)}),tp=e=>{let{editor:t,getPos:n,node:a,updateAttributes:r}=e,l=(0,o.useRef)(null),{src:s,upload:c}=a.attrs,m=(0,o.useRef)(!1),p=(0,u.cn)("left"===a.attrs.align?"ml-0":"ml-auto","right"===a.attrs.align?"mr-0":"mr-auto","center"===a.attrs.align&&"mx-auto"),{uploadRemote:h}=ti();c&&!m.current&&(m.current=!0,h(c).then(e=>{r({src:e,upload:""})}));let g=(0,o.useCallback)(()=>{t.commands.setNodeSelection(n())},[n,t.commands]);return(0,i.jsx)(d.T5,{children:(0,i.jsx)("div",{className:p,style:{width:a.attrs.width},children:(0,i.jsx)("div",{contentEditable:!1,ref:l,children:(0,i.jsx)("img",{className:"block",src:s,alt:"",onClick:g})})})})},th=e9.extend({name:"imageBlock",group:"block",defining:!0,isolating:!0,addAttributes:()=>({src:{default:"",parseHTML:e=>e.getAttribute("src"),renderHTML:e=>({src:e.src})},width:{default:"100%",parseHTML:e=>e.getAttribute("data-width"),renderHTML:e=>({"data-width":e.width})},align:{default:"center",parseHTML:e=>e.getAttribute("data-align"),renderHTML:e=>({"data-align":e.align})},alt:{default:void 0,parseHTML:e=>e.getAttribute("alt"),renderHTML:e=>({alt:e.alt})},upload:{default:void 0,parseHTML:e=>e.getAttribute("data-src"),rendered:!1}}),parseHTML:()=>[{tag:'img[src*="localhost"]:not([src^="data:"]), img[src*="dsb.cn"]:not([src^="data:"], img[src*="pai.com.cn"]:not([src^="data:"], img[src*="aliyuncs.com"]:not([src^="data:"])'}],renderHTML(e){let{HTMLAttributes:t}=e;return["img",(0,ec.P1)(this.options.HTMLAttributes,t)]},addCommands:()=>({setImageBlock:e=>t=>{let{commands:n}=t;return n.insertContent({type:"imageBlock",attrs:{src:e.src}})},setImageBlockAt:e=>t=>{let{commands:n}=t;return n.insertContentAt(e.pos,{type:"imageBlock",attrs:{src:e.src}})},setImageBlockAlign:e=>t=>{let{commands:n}=t;return n.updateAttributes("imageBlock",{align:e})},setImageBlockWidth:e=>t=>{let{commands:n}=t;return n.updateAttributes("imageBlock",{width:"".concat(Math.max(0,Math.min(100,e)),"%")})}}),addNodeView:()=>(0,d.fW)(tp)});(r=l||(l={})).SidebarLeft="sidebar-left",r.SidebarRight="sidebar-right",r.TwoColumn="two-column";let tg=ec.NB.create({name:"columns",group:"columns",content:"column column",defining:!0,isolating:!0,addAttributes:()=>({layout:{default:"two-column"}}),addCommands:()=>({setColumns:()=>e=>{let{commands:t}=e;return t.insertContent('<div data-type="columns"><div data-type="column" data-position="left"><p></p></div><div data-type="column" data-position="right"><p></p></div></div>')},setLayout:e=>t=>{let{commands:n}=t;return n.updateAttributes("columns",{layout:e})}}),renderHTML(e){let{HTMLAttributes:t}=e;return["div",{"data-type":"columns",class:"layout-".concat(t.layout)},0]},parseHTML:()=>[{tag:'div[data-type="columns"]'}]}),tf=ec.NB.create({name:"column",content:"block+",isolating:!0,addAttributes:()=>({position:{default:"",parseHTML:e=>e.getAttribute("data-position"),renderHTML:e=>({"data-position":e.position})}}),renderHTML(e){let{HTMLAttributes:t}=e;return["div",(0,ec.P1)(t,{"data-type":"column"}),0]},parseHTML:()=>[{tag:'div[data-type="column"]'}]}),tx=(0,o.memo)(e=>{let{editor:t,onItemClick:n}=e,[a,r]=(0,o.useState)(null);return(0,o.useEffect)(()=>{let e=e=>{let{editor:t}=e;r({...t.extensionStorage.tableOfContents})};return e({editor:t}),t.on("update",e),t.on("selectionUpdate",e),()=>{t.off("update",e),t.off("selectionUpdate",e)}},[t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mb-2 text-xs font-semibold uppercase text-neutral-500 dark:text-neutral-400",children:"目录"}),a&&a.content.length>0?(0,i.jsx)("div",{className:"flex flex-col gap-1",children:a.content.map(e=>(0,i.jsxs)("a",{href:"#".concat(e.id),style:{marginLeft:"".concat(1*e.level-1,"rem")},onClick:n,className:(0,u.cn)("block w-full truncate rounded p-1 text-sm font-medium text-neutral-500 transition-all hover:bg-black/5 hover:text-neutral-800 dark:text-neutral-300",e.isActive&&"bg-neutral-100/10 text-neutral-800 dark:bg-neutral-900 dark:text-neutral-100"),children:[e.itemIndex,". ",e.textContent]},e.id))}):(0,i.jsx)("div",{className:"text-sm text-neutral-500",children:"文章标题显示在这里 …"})]})});tx.displayName="TableOfContents";let tb=e=>{let{editor:t}=e;return(0,i.jsx)(d.T5,{children:(0,i.jsx)("div",{className:"-m-2 rounded-lg p-2",contentEditable:!1,children:(0,i.jsx)(tx,{editor:t})})})},tv=ec.NB.create({name:"tableOfContentsNode",group:"block",atom:!0,selectable:!0,draggable:!0,inline:!1,parseHTML:()=>[{tag:'div[data-type="table-of-content"]'}],renderHTML(e){let{HTMLAttributes:t}=e;return["div",{...t,"data-type":"table-of-content"}]},addNodeView:()=>(0,d.fW)(tb),addCommands(){return{insertTableOfContents:()=>e=>{let{commands:t}=e;return t.insertContent({type:this.name})}}}}),ty=e=>{let t=e;for(;t&&!["TD","TH"].includes(t.tagName);)t=t.parentElement;let n=t&&t.querySelector&&t.querySelector("a.grip-column.selected"),a=t&&t.querySelector&&t.querySelector("a.grip-row.selected");return!!n||!!a},tk=(e,t)=>[eU.name,th.name,tm.name,ei.dn.name,th.name,e7.name,eC.name,eA.name,e4.name,tv.name].some(t=>e.isActive(t))||ty(t),tj=e=>{let{editor:t}=e,{state:{doc:n,selection:a,selection:{empty:r,from:l,to:i}}}=t,o=!n.textBetween(l,i).length&&(0,ec.xh)(a);return!r&&!o&&!!t.isEditable},tw=e=>{var t,n,a,r;let l=(0,o.useCallback)(t=>{let{view:n,from:a}=t;if(!n)return!1;let r=n.domAtPos(a||0).node;return!tk(e,n.nodeDOM(a||0)||r)&&tj({editor:e})},[e]);return{isBold:e.isActive("bold"),isItalic:e.isActive("italic"),isStrike:e.isActive("strike"),isUnderline:e.isActive("underline"),isCode:e.isActive("code"),isSubscript:e.isActive("subscript"),isSuperscript:e.isActive("superscript"),isAlignLeft:e.isActive({textAlign:"left"}),isAlignCenter:e.isActive({textAlign:"center"}),isAlignRight:e.isActive({textAlign:"right"}),isAlignJustify:e.isActive({textAlign:"justify"}),currentColor:(null===(t=e.getAttributes("textStyle"))||void 0===t?void 0:t.color)||void 0,currentHighlight:(null===(n=e.getAttributes("highlight"))||void 0===n?void 0:n.color)||void 0,currentFont:(null===(a=e.getAttributes("textStyle"))||void 0===a?void 0:a.fontFamily)||void 0,currentSize:(null===(r=e.getAttributes("textStyle"))||void 0===r?void 0:r.fontSize)||void 0,shouldShow:l}},tC=(0,o.memo)(j.Button),tN=(0,o.memo)(e=>{let{color:t,onChange:n,onClear:a}=e,[r,l]=(0,o.useState)(t||""),s=(0,o.useCallback)(e=>{l(e.target.value)},[]),d=(0,o.useCallback)(()=>{if(!/^#([0-9A-F]{3}){1,2}$/i.test(r)){n&&n("");return}n&&n(r)},[r,n]);return(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)(C.gW,{className:"w-full",color:t||"",onChange:n}),(0,i.jsx)("input",{type:"text",className:"w-full rounded border border-neutral-200 bg-white p-2 text-black focus:outline-1 focus:outline-neutral-300 focus:ring-0 dark:border-neutral-800 dark:bg-black dark:text-white dark:focus:outline-neutral-700",placeholder:"#000000",value:r,onChange:s,onBlur:d}),(0,i.jsxs)("div",{className:"flex max-w-60 flex-wrap items-center gap-1",children:[A.map(e=>(0,i.jsx)(N,{active:e===t,color:e,onColorChange:n},e)),(0,i.jsx)(j.Button,{tooltip:"Reset color to default",onClick:a,children:(0,i.jsx)(m,{name:"Undo"})})]})]})}),tS=(0,o.memo)(e=>{let{onChange:t,value:n}=e,a=$.find(e=>e.value===n),r=(null==a?void 0:a.label.split(" ")[0])||"Inter",l=(0,o.useCallback)(e=>()=>t(e),[t]);return(0,i.jsxs)(I.fC,{children:[(0,i.jsx)(I.xz,{asChild:!0,children:(0,i.jsxs)(j.Button,{active:!!(null==a?void 0:a.value),children:[r,(0,i.jsx)(m,{name:"ChevronDown",className:"size-2"})]})}),(0,i.jsx)(I.VY,{asChild:!0,children:(0,i.jsx)(p,{className:"flex flex-col gap-1 px-2 py-4",children:D.map(e=>(0,i.jsxs)("div",{className:"mt-2.5 flex flex-col gap-0.5 first:mt-0",children:[(0,i.jsx)(B,{children:e.label}),e.options.map(e=>(0,i.jsx)(_,{isActive:n===e.value,onClick:l(e.value),children:(0,i.jsx)("span",{style:{fontFamily:e.value},children:e.label})},"".concat(e.label,"_").concat(e.value)))]},e.label))})})]})}),tA=(0,o.memo)(e=>{let{onChange:t,value:n}=e,a=O.find(e=>e.value===n),r=(null==a?void 0:a.label.split(" ")[0])||"Medium",l=(0,o.useCallback)(e=>()=>t(e),[t]);return(0,i.jsxs)(I.fC,{children:[(0,i.jsx)(I.xz,{asChild:!0,children:(0,i.jsxs)(j.Button,{active:!!(null==a?void 0:a.value),children:[r,(0,i.jsx)(m,{name:"ChevronDown",className:"size-2"})]})}),(0,i.jsx)(I.VY,{asChild:!0,children:(0,i.jsx)(p,{className:"flex flex-col gap-1 px-2 py-4",children:O.map(e=>(0,i.jsx)(_,{isActive:n===e.value,onClick:l(e.value),children:(0,i.jsx)("span",{style:{fontSize:e.value},children:e.label})},"".concat(e.label,"_").concat(e.value)))})})]})}),tL=(0,o.memo)(e=>{let{options:t}=e,n=(0,o.useMemo)(()=>t.find(e=>"option"===e.type&&e.isActive()),[t]);return(0,i.jsxs)(I.fC,{children:[(0,i.jsx)(I.xz,{asChild:!0,children:(0,i.jsxs)(j.Button,{active:(null==n?void 0:n.id)!=="paragraph"&&!!(null==n?void 0:n.type),children:[(0,i.jsx)(m,{name:(null==n?void 0:n.type)==="option"&&n.icon||"Pilcrow"}),(0,i.jsx)(m,{name:"ChevronDown",className:"size-2"})]})}),(0,i.jsx)(I.VY,{asChild:!0,children:(0,i.jsx)(p,{className:"flex flex-col gap-1 px-2 py-4",children:t.map(e=>z(e)?(0,i.jsxs)(_,{onClick:e.onClick,isActive:e.isActive(),children:[(0,i.jsx)(m,{name:e.icon,className:"mr-1 size-4"}),e.label]},e.id):R(e)?(0,i.jsx)("div",{className:"mt-2 first:mt-0",children:(0,i.jsx)(B,{children:e.label},e.id)},e.id):void 0)})})]})}),tT=e=>{let{editor:t}=e,n=F(t),a=tw(t),r=q(t);return(0,i.jsx)(d.NM,{tippyOptions:{popperOptions:{placement:"top-start"}},editor:t,pluginKey:"textMenu",shouldShow:a.shouldShow,updateDelay:100,children:(0,i.jsxs)(j.Wrapper,{children:[(0,i.jsx)(tL,{options:r}),(0,i.jsx)(tS,{onChange:n.onSetFont,value:a.currentFont||""}),(0,i.jsx)(tA,{onChange:n.onSetFontSize,value:a.currentSize||""}),(0,i.jsx)(j.Divider,{}),(0,i.jsx)(tC,{tooltip:"加粗",tooltipShortcut:["Mod","B"],onClick:n.onBold,active:a.isBold,children:(0,i.jsx)(m,{name:"Bold"})}),(0,i.jsx)(tC,{tooltip:"斜体",tooltipShortcut:["Mod","I"],onClick:n.onItalic,active:a.isItalic,children:(0,i.jsx)(m,{name:"Italic"})}),(0,i.jsx)(tC,{tooltip:"下划线",tooltipShortcut:["Mod","U"],onClick:n.onUnderline,active:a.isUnderline,children:(0,i.jsx)(m,{name:"Underline"})}),(0,i.jsx)(tC,{tooltip:"删除线",tooltipShortcut:["Mod","X"],onClick:n.onStrike,active:a.isStrike,children:(0,i.jsx)(m,{name:"Strikethrough"})}),(0,i.jsx)(tC,{tooltip:"左对齐",tooltipShortcut:["Shift","Mod","L"],onClick:n.onAlignLeft,active:a.isAlignLeft,children:(0,i.jsx)(m,{name:"AlignLeft"})}),(0,i.jsx)(tC,{tooltip:"居中对齐",tooltipShortcut:["Shift","Mod","E"],onClick:n.onAlignCenter,active:a.isAlignCenter,children:(0,i.jsx)(m,{name:"AlignCenter"})}),(0,i.jsx)(tC,{tooltip:"右对齐",onClick:n.onAlignRight,active:a.isAlignRight,children:(0,i.jsx)(m,{name:"AlignRight"})}),(0,i.jsx)(tC,{tooltip:"两端对齐",tooltipShortcut:["Shift","Mod","J"],onClick:n.onAlignJustify,active:a.isAlignJustify,children:(0,i.jsx)(m,{name:"AlignJustify"})}),(0,i.jsx)(E,{onSetLink:n.onLink}),(0,i.jsxs)(H.fC,{children:[(0,i.jsx)(H.xz,{asChild:!0,children:(0,i.jsx)(tC,{active:!!a.currentHighlight,tooltip:"高亮文本",tooltipShortcut:["Mod","Shift","H"],children:(0,i.jsx)(m,{name:"Highlighter"})})}),(0,i.jsx)(H.VY,{side:"top",sideOffset:8,asChild:!0,children:(0,i.jsx)(p,{className:"p-1",children:(0,i.jsx)(tN,{color:a.currentHighlight,onChange:n.onChangeHighlight,onClear:n.onClearHighlight})})})]}),(0,i.jsxs)(H.fC,{children:[(0,i.jsx)(H.xz,{asChild:!0,children:(0,i.jsx)(tC,{active:!!a.currentColor,tooltip:"文本颜色",children:(0,i.jsx)(m,{name:"Palette"})})}),(0,i.jsx)(H.VY,{side:"top",sideOffset:8,asChild:!0,children:(0,i.jsx)(p,{className:"p-1",children:(0,i.jsx)(tN,{color:a.currentColor,onChange:n.onChangeColor,onClear:n.onClearColor})})})]}),(0,i.jsxs)(H.fC,{children:[(0,i.jsx)(H.xz,{asChild:!0,children:(0,i.jsx)(tC,{tooltip:"更多选项",children:(0,i.jsx)(m,{name:"ListCollapse"})})}),(0,i.jsx)(H.VY,{side:"top",asChild:!0,children:(0,i.jsxs)(j.Wrapper,{children:[(0,i.jsx)(tC,{tooltip:"下标",tooltipShortcut:["Mod",","],onClick:n.onSubscript,active:a.isSubscript,children:(0,i.jsx)(m,{name:"Subscript"})}),(0,i.jsx)(tC,{tooltip:"上标",tooltipShortcut:["Mod","."],onClick:n.onSuperscript,active:a.isSuperscript,children:(0,i.jsx)(m,{name:"Superscript"})}),(0,i.jsx)(j.Divider,{}),(0,i.jsx)(tC,{tooltip:"代码",tooltipShortcut:["Mod","E"],onClick:n.onCode,active:a.isCode,children:(0,i.jsx)(m,{name:"Code"})}),(0,i.jsx)(tC,{tooltip:"代码块",tooltipShortcut:["Mod","Alt","C"],onClick:n.onCodeBlock,children:(0,i.jsx)(m,{name:"CodeXml"})})]})})]})]})})};var tP=n(7736),tM=(e,t,n)=>{let a=(0,o.useCallback)(()=>{let a=e.chain();a.setNodeSelection(n).unsetAllMarks(),(null==t?void 0:t.type.name)!=="paragraph"&&a.setParagraph(),a.run()},[e,n,null==t?void 0:t.type.name]),r=(0,o.useCallback)(()=>{e.commands.setNodeSelection(n);let{$anchor:a}=e.state.selection,r=a.node(1)||e.state.selection.node;e.chain().setMeta("hideDragHandle",!0).insertContentAt(n+((null==t?void 0:t.nodeSize)||0),r.toJSON()).run()},[e,n,null==t?void 0:t.nodeSize]);return{resetTextFormatting:a,duplicateNode:r,copyNodeToClipboard:(0,o.useCallback)(()=>{e.chain().setMeta("hideDragHandle",!0).setNodeSelection(n).run(),document.execCommand("copy")},[e,n]),deleteNode:(0,o.useCallback)(()=>{e.chain().setMeta("hideDragHandle",!0).setNodeSelection(n).deleteSelection().run()},[e,n]),handleAdd:(0,o.useCallback)(()=>{if(-1!==n){var a;let r=n+((null==t?void 0:t.nodeSize)||0),l=(null==t?void 0:t.type.name)==="paragraph"&&(null==t?void 0:null===(a=t.content)||void 0===a?void 0:a.size)===0,i=l?n+2:r+2;e.chain().command(e=>{let{dispatch:t,tr:a,state:i}=e;return!t||(l?a.insertText("/",n,n+1):a.insert(r,i.schema.nodes.paragraph.create(null,[i.schema.text("/")])),t(a))}).focus(i).run()}},[t,n,e])}};let tH=()=>{let[e,t]=(0,o.useState)(null),[n,a]=(0,o.useState)(-1),r=(0,o.useCallback)(e=>{e.node&&t(e.node),a(e.pos)},[a,t]);return{currentNode:e,currentNodePos:n,setCurrentNode:t,setCurrentNodePos:a,handleNodeChange:r}},tI=e=>{let{editor:t}=e,[n,a]=(0,o.useState)(!1),r=tH(),l=tM(t,r.currentNode,r.currentNodePos);return(0,o.useEffect)(()=>{n?t.commands.setMeta("lockDragHandle",!0):t.commands.setMeta("lockDragHandle",!1)},[t,n]),(0,i.jsx)(tP.Z,{pluginKey:"ContentItemMenu",editor:t,onNodeChange:r.handleNodeChange,tippyOptions:{offset:[-2,16],zIndex:99},children:(0,i.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,i.jsx)(j.Button,{onClick:l.handleAdd,children:(0,i.jsx)(m,{name:"Plus"})}),(0,i.jsxs)(H.fC,{open:n,onOpenChange:a,children:[(0,i.jsx)(H.xz,{asChild:!0,children:(0,i.jsx)(j.Button,{children:(0,i.jsx)(m,{name:"GripVertical"})})}),(0,i.jsx)(H.VY,{side:"bottom",align:"start",sideOffset:8,children:(0,i.jsxs)(p,{className:"flex min-w-[16rem] flex-col p-2",children:[(0,i.jsx)(H.x8,{asChild:!0,children:(0,i.jsxs)(_,{onClick:l.resetTextFormatting,children:[(0,i.jsx)(m,{name:"RemoveFormatting"}),"清除格式"]})}),(0,i.jsx)(H.x8,{asChild:!0,children:(0,i.jsxs)(_,{onClick:l.copyNodeToClipboard,children:[(0,i.jsx)(m,{name:"Clipboard"}),"复制到剪贴板"]})}),(0,i.jsx)(H.x8,{asChild:!0,children:(0,i.jsxs)(_,{onClick:l.duplicateNode,children:[(0,i.jsx)(m,{name:"Copy"}),"重复段落"]})}),(0,i.jsx)(j.Divider,{horizontal:!0}),(0,i.jsx)(H.x8,{asChild:!0,children:(0,i.jsxs)(_,{onClick:l.deleteNode,className:"bg-red-500/10 text-red-500 hover:bg-red-500/20 dark:text-red-500 dark:hover:bg-red-500/20 dark:hover:text-red-500",children:[(0,i.jsx)(m,{name:"Trash2"}),"删除段落"]})})]})})]})]})})};var tB=n(99388);let t_=(0,o.memo)(e=>{let{editor:t,isOpen:n,onClose:a}=e,r=(0,o.useCallback)(()=>{window.innerWidth<1024&&a()},[a]);(0,o.useEffect)(()=>{let e=20,t=document.getElementById("editor-header");t instanceof HTMLElement&&(e+=t.offsetHeight);let n=()=>{if(window.location.hash){let t=document.getElementById("editor-content");t&&t.scrollBy(0,-e)}};return window.addEventListener("hashchange",n),()=>{window.removeEventListener("hashchange",n)}},[]);let l=(0,u.cn)("absolute left-0 top-0 z-[999] h-full w-0 bg-white transition-all duration-300 lg:relative lg:h-auto lg:bg-white/30 lg:backdrop-blur-xl","dark:bg-black lg:dark:bg-black/30",!n&&"border-r-transparent",n&&"w-80 border-r border-r-neutral-200 dark:border-r-neutral-800");return(0,i.jsxs)("div",{className:l,children:[(0,i.jsx)("div",{className:"size-full overflow-hidden",children:(0,i.jsx)("div",{className:"size-full overflow-auto p-6",children:(0,i.jsx)(tx,{onItemClick:r,editor:t})})}),(0,i.jsx)("div",{className:"absolute right-6 top-5",children:(0,i.jsx)(tB.Z,{onClick:a,size:16,color:"#6d6464"})})]})});t_.displayName="TableOfContentSidepanel";var tz=n(59640),tR=n(72320),tE=n(19845);let tD=new eu.Sy({state:{init(e,t){let{doc:n}=t,a=[];for(let e=1;e<n.content.size;e+=4)a.push(em.p.inline(e-1,e,{style:"background: yellow"}));return em.EH.create(n,a)},apply:(e,t)=>t.map(e.mapping,e.doc)},props:{decorations:e=>tD.getState(e)}}),t$=ec.hj.create({name:"htmlPaste",addProseMirrorPlugins:()=>[new eu.Sy({key:new eu.H$("htmlPaste"),state:{init:()=>em.EH.empty,apply:(e,t)=>t=t.map(e.mapping,e.doc)},props:{transformPastedHTML(e){let t=new DOMParser().parseFromString(e,"text/html"),n=Array.from(t.querySelectorAll("img")),a=[];n.forEach(e=>{let n=e.parentElement;for(;n&&n.parentElement!==t.body;)n=n.parentElement;e.dataset.src=e.src,e.src="https://www.dsb.cn/assets/images/placeholder-800.jpg",n&&a.push(n),n&&t.body.insertBefore(e,n)}),a.forEach(e=>{e&&e.remove()});for(var r=t.querySelectorAll("*"),l=0;l<r.length;l++){let e=r[l];e.style.fontFamily="",e.style.fontSize=""}return t.body.innerHTML}},appendTransaction:(e,t,n)=>null})]}),tO=e5.Ee.extend({name:"imageInline",group:"inline",inline:!0,draggable:!0,selectable:!0,parseHTML:()=>[{tag:'p img[src*="pai.com.cn"]:not([src^="data:"]),p img[src*="localhost"]:not([src^="data:"]),p img[src*="dsb.cn"]:not([src^="data:"])'}]}),tF=/^(https?:\/\/)?(www\.|music\.)?(youtube\.com|youtu\.be)\/(?!channel\/)(?!@)(.+)?$/g,tq=ec.NB.create({name:"videocode",addOptions:()=>({addPasteHandler:!0,allowFullscreen:!0,autoplay:!1,ccLanguage:void 0,ccLoadPolicy:void 0,controls:!0,disableKBcontrols:!1,enableIFrameApi:!1,endTime:0,height:480,interfaceLanguage:void 0,ivLoadPolicy:0,loop:!1,modestBranding:!1,HTMLAttributes:{},inline:!1,nocookie:!1,origin:"",playlist:"",progressBarColor:void 0,width:640,frameborder:0}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},start:{default:0},width:{default:this.options.width},height:{default:this.options.height}}},parseHTML:()=>[{tag:"div[data-iframe-video] iframe"}],addCommands(){return{setVideoCode:e=>t=>{let{commands:n}=t;return n.insertContent({type:this.name,attrs:e})}}},addPasteRules(){return this.options.addPasteHandler?[(0,ec.Ss)({find:tF,type:this.type,getAttributes:e=>({src:e.input})})]:[]},renderHTML(e){let{HTMLAttributes:t}=e;return["div",{"data-iframe-video":""},["iframe",(0,ec.P1)(this.options.HTMLAttributes,{width:this.options.width,height:this.options.height,allowfullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor,frameborder:this.options.frameborder},t)]]}}),tU=(0,tR.B)(tE.y);var tW=e=>{let{userId:t,userName:n="Maxi"}=e;return[eZ,tg,es.a,eo.Uf.configure({nested:!0}),tf,ep,eW.configure({levels:[1,2,3,4,5,6]}),eU,W.V.configure({document:!1,dropcursor:!1,heading:!1,horizontalRule:!1,blockquote:!1,codeBlock:!1}),tz.H.configure({lowlight:tU,defaultLanguage:null}),J.p,e1,Y.b,ee.I,eG,e7.configure({openOnClick:!1}),Z.y$.configure({multicolor:!0}),G.v,V.H.configure({limit:5e4}),er.o5,tv,tm.configure({}),tO.configure({inline:!0}),th,ed.Xx.configure({allowedMimeTypes:["image/png","image/jpeg","image/gif","image/webp"],onDrop:async(e,t,n)=>{for(let a of t){let t=await tl(a);e.chain().setImageBlockAt({pos:n,src:t}).focus().run()}},onPaste:async(e,t)=>{for(let n of t){let t=await tl(n);e.chain().setImageBlockAt({pos:e.state.selection.anchor,src:t}).focus().run()}}}),K.P.extend({addKeyboardShortcuts:()=>({})}).configure({types:["heading","paragraph"]}),ea.a,el.$,eL,eO,eq,eF,Q.ZT,X.V.configure({includeChildren:!0,showOnlyCurrent:!1,placeholder:()=>""}),e0,et.F,e4,e6,en.m.configure({width:2,class:"ProseMirror-dropcursor border-black"}),t$,tq]};let tZ=(0,o.memo)(e=>{let{onChange:t,value:n}=e,[a,r]=(0,o.useState)(n);(0,o.useEffect)(()=>{r(n)},[n]);let l=(0,o.useCallback)(e=>{t(parseInt(e.target.value))},[t]);return(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("input",{className:"h-2 appearance-none rounded border-0 bg-neutral-200 fill-neutral-300",type:"range",min:"25",max:"100",step:"25",onChange:l,value:a}),(0,i.jsxs)("span",{className:"select-none text-xs font-semibold text-neutral-500",children:[n,"%"]})]})});tZ.displayName="ImageBlockWidth";var tV=e=>{let{editor:t,appendTo:n}=e,a=(0,o.useRef)(null),r=(0,o.useRef)(null),l=(0,o.useCallback)(()=>{let e=U(t,"node-imageBlock");return(null==e?void 0:e.getBoundingClientRect())||new DOMRect(-1e3,-1e3,0,0)},[t]),s=(0,o.useCallback)(()=>t.isActive("imageBlock"),[t]),c=(0,o.useCallback)(()=>{t.chain().focus(void 0,{scrollIntoView:!1}).setImageBlockAlign("left").run()},[t]),u=(0,o.useCallback)(()=>{t.chain().focus(void 0,{scrollIntoView:!1}).setImageBlockAlign("center").run()},[t]),p=(0,o.useCallback)(()=>{t.chain().focus(void 0,{scrollIntoView:!1}).setImageBlockAlign("right").run()},[t]),h=(0,o.useCallback)(e=>{t.chain().focus(void 0,{scrollIntoView:!1}).setImageBlockWidth(e).run()},[t]);return(0,i.jsx)(d.NM,{editor:t,pluginKey:"imageBlockMenu-".concat((0,eh.Z)()),shouldShow:s,updateDelay:0,tippyOptions:{offset:[0,8],popperOptions:{modifiers:[{name:"flip",enabled:!1}]},getReferenceClientRect:l,onCreate:e=>{r.current=e},appendTo:()=>null==n?void 0:n.current,plugins:[eK.CA],sticky:"popper"},children:(0,i.jsxs)(j.Wrapper,{shouldShowContent:s(),ref:a,children:[(0,i.jsx)(j.Button,{tooltip:"Align image left",active:t.isActive("imageBlock",{align:"left"}),onClick:c,children:(0,i.jsx)(m,{name:"AlignHorizontalDistributeStart"})}),(0,i.jsx)(j.Button,{tooltip:"Align image center",active:t.isActive("imageBlock",{align:"center"}),onClick:u,children:(0,i.jsx)(m,{name:"AlignHorizontalDistributeCenter"})}),(0,i.jsx)(j.Button,{tooltip:"Align image right",active:t.isActive("imageBlock",{align:"right"}),onClick:p,children:(0,i.jsx)(m,{name:"AlignHorizontalDistributeEnd"})}),(0,i.jsx)(j.Divider,{}),(0,i.jsx)(tZ,{onChange:h,value:parseInt(t.getAttributes("imageBlock").width)})]})})};let tG=e=>{let{editor:t,appendTo:n}=e,a=(0,o.useCallback)(()=>{let e=U(t,"columns");return(null==e?void 0:e.getBoundingClientRect())||new DOMRect(-1e3,-1e3,0,0)},[t]),r=(0,o.useCallback)(()=>t.isActive("columns"),[t]),s=(0,o.useCallback)(()=>{t.chain().focus().setLayout(l.SidebarLeft).run()},[t]),c=(0,o.useCallback)(()=>{t.chain().focus().setLayout(l.SidebarRight).run()},[t]),u=(0,o.useCallback)(()=>{t.chain().focus().setLayout(l.TwoColumn).run()},[t]);return(0,i.jsx)(d.NM,{editor:t,pluginKey:"columnsMenu-".concat((0,eh.Z)()),shouldShow:r,updateDelay:0,tippyOptions:{offset:[0,8],popperOptions:{modifiers:[{name:"flip",enabled:!1}]},getReferenceClientRect:a,appendTo:()=>null==n?void 0:n.current,plugins:[eK.CA],sticky:"popper"},children:(0,i.jsxs)(j.Wrapper,{children:[(0,i.jsx)(j.Button,{tooltip:"Sidebar left",active:t.isActive("columns",{layout:l.SidebarLeft}),onClick:s,children:(0,i.jsx)(m,{name:"PanelLeft"})}),(0,i.jsx)(j.Button,{tooltip:"Two columns",active:t.isActive("columns",{layout:l.TwoColumn}),onClick:u,children:(0,i.jsx)(m,{name:"Columns2"})}),(0,i.jsx)(j.Button,{tooltip:"Sidebar right",active:t.isActive("columns",{layout:l.SidebarRight}),onClick:c,children:(0,i.jsx)(m,{name:"PanelRight"})})]})})};H.xz,H.h_;let tX=e=>{let{label:t,close:n=!0,icon:a,iconComponent:r,disabled:l,onClick:o,isActive:s}=e,d=(0,u.cn)("flex w-full items-center gap-2 rounded bg-transparent p-1.5 text-left text-sm font-medium text-neutral-500",!s&&!l,"hover:bg-neutral-100 hover:text-neutral-800 dark:hover:bg-neutral-900 dark:hover:text-neutral-200",s&&!l&&"bg-neutral-100 text-neutral-800 dark:bg-neutral-900 dark:text-neutral-200",l&&"cursor-not-allowed text-neutral-400 dark:text-neutral-600"),m=a?c[a]:null,p=n?H.x8:"button";return(0,i.jsxs)(p,{className:d,onClick:o,disabled:l,children:[m&&(0,i.jsx)(m,{className:"size-4"}),r||null,t]})};(0,o.forwardRef)((e,t)=>(0,i.jsx)("hr",{...e,ref:t,className:"my-1 border-neutral-200 dark:border-neutral-800"})).displayName="Divider";let tK=e=>{let{editor:t,view:n,state:a,from:r}=e,l=n.domAtPos(r).node,i=n.nodeDOM(r)||l;if(!t.isActive(eL.name)||!i||e_(a.selection))return!1;let o=i;for(;o&&!["TD","TH"].includes(o.tagName);)o=o.parentElement;return!!(o&&o.querySelector&&o.querySelector("a.grip-column.selected"))},tJ=o.memo(e=>{let{editor:t,appendTo:n}=e,a=(0,o.useCallback)(e=>{let{view:n,state:a,from:r}=e;return!!a&&tK({editor:t,view:n,state:a,from:r||0})},[t]),r=(0,o.useCallback)(()=>{t.chain().focus().addColumnBefore().run()},[t]),l=(0,o.useCallback)(()=>{t.chain().focus().addColumnAfter().run()},[t]),s=(0,o.useCallback)(()=>{t.chain().focus().deleteColumn().run()},[t]);return(0,i.jsx)(d.NM,{editor:t,pluginKey:"tableColumnMenu",updateDelay:0,tippyOptions:{appendTo:()=>null==n?void 0:n.current,offset:[0,15],popperOptions:{modifiers:[{name:"flip",enabled:!1}]}},shouldShow:a,children:(0,i.jsxs)(j.Wrapper,{isVertical:!0,children:[(0,i.jsx)(tX,{iconComponent:(0,i.jsx)(m,{name:"ArrowLeftToLine"}),close:!1,label:"Add column before",onClick:r}),(0,i.jsx)(tX,{iconComponent:(0,i.jsx)(m,{name:"ArrowRightToLine"}),close:!1,label:"Add column after",onClick:l}),(0,i.jsx)(tX,{icon:"Trash",close:!1,label:"Delete column",onClick:s})]})})});tJ.displayName="TableColumnMenu";let tY=e=>{let{editor:t,view:n,state:a,from:r}=e,l=n.domAtPos(r).node,i=n.nodeDOM(r)||l;if(!t.isActive(eL.name)||!i||e_(a.selection))return!1;let o=i;for(;o&&!["TD","TH"].includes(o.tagName);)o=o.parentElement;return!!(o&&o.querySelector&&o.querySelector("a.grip-row.selected"))},tQ=o.memo(e=>{let{editor:t,appendTo:n}=e,a=(0,o.useCallback)(e=>{let{view:n,state:a,from:r}=e;return!!a&&!!r&&tY({editor:t,view:n,state:a,from:r})},[t]),r=(0,o.useCallback)(()=>{t.chain().focus().addRowBefore().run()},[t]),l=(0,o.useCallback)(()=>{t.chain().focus().addRowAfter().run()},[t]),s=(0,o.useCallback)(()=>{t.chain().focus().deleteRow().run()},[t]);return(0,i.jsx)(d.NM,{editor:t,pluginKey:"tableRowMenu",updateDelay:0,tippyOptions:{appendTo:()=>null==n?void 0:n.current,placement:"left",offset:[0,15],popperOptions:{modifiers:[{name:"flip",enabled:!1}]}},shouldShow:a,children:(0,i.jsxs)(j.Wrapper,{isVertical:!0,children:[(0,i.jsx)(tX,{iconComponent:(0,i.jsx)(m,{name:"ArrowUpToLine"}),close:!1,label:"Add row before",onClick:r}),(0,i.jsx)(tX,{iconComponent:(0,i.jsx)(m,{name:"ArrowDownToLine"}),close:!1,label:"Add row after",onClick:l}),(0,i.jsx)(tX,{icon:"Trash",close:!1,label:"Delete row",onClick:s})]})})});tQ.displayName="TableRowMenu";let t0=()=>{let[e,t]=(0,o.useState)(!1);return{isOpen:e,open:(0,o.useCallback)(()=>{t(!0)},[]),close:(0,o.useCallback)(()=>{t(!1)},[]),toggle:(0,o.useCallback)(()=>{t(e=>!e)},[])}};var t1=n(5298),t2=n(75500),t5=n(13590),t9=n(29501),t4=n(27315),t3=n(95011),t8=n(35257),t6=n(62869),t7=n(60332),ne=n(22574),nt=n(26110);function nn(e){let{createPost:t,post:n,setValue:a}=e,[r,l]=(0,o.useState)(null),[s,d]=(0,o.useState)(void 0),c=o.useRef(null),[u,m]=(0,o.useState)(!1),[p,h]=(0,o.useState)(),[g,f]=(0,o.useState)(),x=o.useRef(null),{upload:b}=tr();async function v(){try{let e=await na(c.current,g,"cover"),n=URL.createObjectURL(e);l(n),m(!1);let r=await b(new File([e],"cover.png"));await t(),a("cover_image",r.replace("cover-800","cover-thumb"),{shouldDirty:!0})}catch(e){console.log("error"),l("#")}}(0,o.useEffect)(()=>{x.current&&(x.current.value="")},[u]);let y=r||(null==n?void 0:n.cover_image)||null;return(0,i.jsxs)("div",{children:[y&&(0,i.jsx)("img",{src:y,alt:"cover",style:{width:"260px"}}),(0,i.jsxs)("div",{onClick:()=>{var e;null===(e=x.current)||void 0===e||e.click()},className:"flex cursor-pointer items-center gap-2 pt-2 text-sm text-muted-foreground hover:text-black/80 dark:hover:text-white",children:[(0,i.jsx)(t7.Z,{size:17}),y?"替换":"上传","封面图（默认文章第一张图）"]}),(0,i.jsx)("input",{type:"file",accept:"image/*",ref:x,hidden:!0,onChange:function(e){var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){m(!0),h(void 0);let e=new FileReader;e.onload=()=>{var t;d(null===(t=e.result)||void 0===t?void 0:t.toString())},e.readAsDataURL(n)}}}),(0,i.jsx)(nt.Vq,{open:u,onOpenChange:m,children:(0,i.jsxs)(nt.cZ,{children:[(0,i.jsx)(nt.fK,{children:(0,i.jsx)(nt.$N,{children:"封面裁剪"})}),(0,i.jsx)("div",{className:"flex items-center justify-center",children:(0,i.jsx)(ne.ZP,{crop:p,onChange:(e,t)=>h(t),onComplete:e=>{console.log(e),f(e)},aspect:16/9,keepSelection:!0,minWidth:120,className:"w-full",children:(0,i.jsx)("img",{alt:"Crop preview",ref:c,src:s,onLoad:function(e){var t;let{width:n,height:a}=e.currentTarget;h((t=16/9,(0,ne._H)((0,ne.YG)({unit:"%",width:90},t,n,a),n,a)))},className:"w-full"})})}),(0,i.jsx)(nt.cN,{children:(0,i.jsx)(t6.z,{type:"submit",className:"w-full",onClick:v,children:"保存封面"})})]})})]})}n(83814);let na=(e,t,n)=>{let a=document.createElement("canvas"),r=e.naturalWidth/e.width,l=e.naturalHeight/e.height,i=t.width*r,o=t.height*l;return a.width=i,a.height=o,a.getContext("2d").drawImage(e,t.x*r,t.y*l,i,o,0,0,i,o),new Promise((e,t)=>{a.toBlob(n=>{if(!n){t(Error("Canvas is empty"));return}e(n)},"image/png")})};var nr=n(10811);n(83079);var nl=n(12119);(0,nl.$)("2e9351d8e4c0c79b36bb23ce1d25420c95843ee0");var ni=(0,nl.$)("39e664ce5e34e10becccfcc698d53d6dadec399a");let no=t8.z.object({title:t8.z.string().max(128).optional(),body:t8.z.string().optional(),cover_image:t8.z.string().optional()});async function ns(){let e=await fetch("https://media.dsb.cn/api/20250121/keywords.json");return(await e.json()).keywords}function nd(e){var t,n;let{params:{slugs:a}}=e,[r,l]=(0,o.useState)(!1);async function c(){try{let e=await ns();localStorage.setItem("keywords",JSON.stringify(e)),l(!0)}catch(e){localStorage.setItem("keywords",""),l(!1)}}let p=null==a?void 0:a[0],h=(0,o.useRef)(null),g=(0,o.useRef)(null),f=(0,o.useRef)(""),x=(0,s.useRouter)(),{register:b,setValue:v,getValues:y,formState:k,handleSubmit:w,reset:C,control:N}=(0,t9.cI)({resolver:(0,t5.F)(no),defaultValues:{title:"",body:"",cover_image:""}});b("cover_image");let[S,{called:A,loading:L,data:T,client:P}]=(0,t1.t)(tn.QI,{variables:{slug:p}}),[H,{data:I,loading:B}]=(0,tt.D)(tn.Sx),[_,{data:z,loading:R,error:E}]=(0,tt.D)(tn.vG);async function D(){if(!f.current)return w(async e=>{var t,n,a,r;let l=await H({variables:{input:{title:e.title||"标题",body:e.body||void 0,publish_status:"Draft"}}});return f.current=(null===(n=l.data)||void 0===n?void 0:null===(t=n.createPost)||void 0===t?void 0:t.id)||"",C(e),window.history.replaceState({},"","/editor/".concat(null===(r=l.data)||void 0===r?void 0:null===(a=r.createPost)||void 0===a?void 0:a.slug)),f.current})()}let $=e=>e.replace(/<s[^>]*>([\s\S]*?)<\/s>/gi,"$1"),{data:O}=(0,t2.aM)(tn.ad),F=null==O?void 0:O.viewer,q=t0(),U=k.isDirty,W=(0,d.jE)({content:"",autofocus:!1,extensions:[...tW({})],editorProps:{attributes:{autocomplete:"off",autocorrect:"off",autocapitalize:"off",class:"flex-1 pb-12"},transformPastedHTML(e){let t=function(e,t){let n=e;for(let e of t){let t=RegExp("(".concat(e,")"),"gi");n=n.replace(t,"<s>$1</s>")}return n}(e,JSON.parse(localStorage.getItem("keywords")||"")||[]),n=new DOMParser().parseFromString(t,"text/html");return["a"].forEach(e=>{n.querySelectorAll(e).forEach(e=>{e.replaceWith(...e.childNodes)})}),n.querySelectorAll("ul, ol").forEach(e=>{let t=document.createDocumentFragment();Array.from(e.querySelectorAll("li")).forEach(e=>{var a;let r=n.createElement("p"),l=(null===(a=e.textContent)||void 0===a?void 0:a.trim())||"";r.textContent=l,t.appendChild(r)}),e.replaceWith(...t.childNodes)}),t=new XMLSerializer().serializeToString(n.body)}},onUpdate:e=>{let{editor:t}=e;v("body",t.getHTML(),{shouldDirty:!0})}},[]),Z=(0,t9.qo)({control:N}),[,V]=(0,t3.Z)(()=>{if(""===f.current){let e=y();(""!==e.title||""!==e.body)&&D()}else!U||R||f.current&&w(async e=>{e.body=$(e.body||""),e.title=e.title||"标题",await _({variables:{id:f.current,input:e}}),C(e)})()},3e3,[Z]);if((0,o.useEffect)(()=>{p&&!A&&W&&S().then(e=>{var t,n,a,r,l,i,o,s,d,c;f.current=(null===(n=e.data)||void 0===n?void 0:null===(t=n.post)||void 0===t?void 0:t.id)||"",null==W||W.commands.setContent((null===(r=e.data)||void 0===r?void 0:null===(a=r.post)||void 0===a?void 0:a.body)||"",!0),C({title:(null===(i=e.data)||void 0===i?void 0:null===(l=i.post)||void 0===l?void 0:l.title)||"",body:(null===(s=e.data)||void 0===s?void 0:null===(o=s.post)||void 0===o?void 0:o.body)||"",cover_image:(null===(c=e.data)||void 0===c?void 0:null===(d=c.post)||void 0===d?void 0:d.cover_image)||""})}),r||c()},[p,A,S,W,C,r]),A&&L)return(0,i.jsx)("p",{children:"获取数据 ..."});if(!W)return(0,i.jsx)("p",{children:"编辑器初始化 ..."});if(!r)return(0,i.jsx)("p",{children:"关键词加载中..."});let G=(null==W?void 0:W.storage.characterCount)||{characters:()=>0,words:()=>0},X=G.characters(),K=G.words();return(0,i.jsxs)("div",{className:"flex h-full",ref:h,children:[(0,i.jsx)(t_,{isOpen:q.isOpen,onClose:q.close,editor:W}),(0,i.jsxs)("div",{id:"editor-content",className:"relative flex h-full min-h-screen flex-1 flex-col overflow-hidden overflow-y-auto",children:[(0,i.jsxs)("div",{id:"editor-header",className:(0,u.cn)("flex flex-none flex-row items-center justify-between border-b border-neutral-200 bg-white py-2 pl-6 pr-3 text-black dark:border-neutral-800 dark:bg-black dark:text-white","sticky top-0 z-[100]"),children:[(0,i.jsxs)("div",{className:"flex flex-row items-center gap-x-1.5",children:[(0,i.jsx)("div",{className:"flex items-center gap-x-1.5",children:(0,i.jsx)(j.Button,{tooltip:(null==q?void 0:q.isOpen)?"关闭侧边栏":"打开侧边栏",onClick:null==q?void 0:q.toggle,active:null==q?void 0:q.isOpen,className:(null==q?void 0:q.isOpen)?"bg-transparent":"",children:(0,i.jsx)(m,{name:(null==q?void 0:q.isOpen)?"PanelLeftClose":"PanelLeft"})})}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground lg:ml-5",children:(null==T?void 0:null===(t=T.post)||void 0===t?void 0:t.publish_status)=="Draft"?"草稿":"已发布"}),(0,i.jsx)("div",{className:"lg:ml-5",children:(0,i.jsx)("div",{className:"text-sm text-muted-foreground/50",children:U?R?"保存中...":"编辑自动保存":"保存成功"})})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(t6.z,{disabled:R,className:"mr-5 h-9 rounded-sm",onClick:function(){f.current&&w(async e=>{e.body=$(e.body||""),e.title=e.title||"标题";let t={...e,publish_status:"Published"},n=await _({variables:{id:f.current,input:t}});C(e),P.clearStore(),await ni(n.data.updatePost.url),x.push("/dashboard")})()},children:(null==T?void 0:null===(n=T.post)||void 0===n?void 0:n.publish_status)=="Draft"?"发布":"保存并发布"}),(0,i.jsxs)("div",{className:"mr-4 hidden flex-col justify-center border-r border-neutral-200 pr-4 text-right dark:border-neutral-800 lg:flex",children:[(0,i.jsxs)("div",{className:"text-xs font-semibold text-neutral-500 dark:text-neutral-400",children:[K," ","空格"]}),(0,i.jsxs)("div",{className:"text-xs font-semibold text-neutral-500 dark:text-neutral-400",children:[X," ","字符"]})]}),F?(0,i.jsx)(nr.R,{user:F}):(0,i.jsx)("div",{className:"h-10",children:" "})]})]}),(0,i.jsx)("div",{className:"ProseMirror mb-4 pt-8",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"mb-8",children:(0,i.jsx)(nn,{createPost:D,post:null==T?void 0:T.post,setValue:v})}),(0,i.jsx)(t4.Z,{onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),W.commands.focus("end"))},id:"title",defaultValue:"",placeholder:"标题",className:"w-full resize-none appearance-none overflow-hidden bg-transparent text-5xl font-bold focus:outline-none",...b("title")})]})}),(0,i.jsx)(d.kg,{editor:W,ref:g,className:"flex flex-1 flex-col"}),(0,i.jsx)(tI,{editor:W}),(0,i.jsx)(M,{editor:W,appendTo:h}),(0,i.jsx)(tT,{editor:W}),(0,i.jsx)(tG,{editor:W,appendTo:h}),(0,i.jsx)(tQ,{editor:W,appendTo:h}),(0,i.jsx)(tJ,{editor:W,appendTo:h}),(0,i.jsx)(tV,{editor:W,appendTo:h})]})]})}},50921:function(e,t,n){"use strict";n.d(t,{Sx:function(){return K},Xv:function(){return E},UC:function(){return D},uA:function(){return B},QI:function(){return _},p$:function(){return z},Rz:function(){return G},pk:function(){return X},Ys:function(){return F},L4:function(){return V},uS:function(){return Z},Nv:function(){return q},ME:function(){return O},iw:function(){return R},NF:function(){return W},vG:function(){return J},AX:function(){return Y},uk:function(){return U},ad:function(){return $}});var a=n(45008),r=n(2559);function l(){let e=(0,a._)(["\n  fragment postListItemFragment on Post {\n    id\n    title\n    slug\n    summary\n    url\n    cover_image\n    publish_status\n    view_count\n    status\n    status_desc\n    created_at\n    published_at\n    publish_at_diff_humans\n    deleted_at\n  }\n"]);return l=function(){return e},e}function i(){let e=(0,a._)(["\n  fragment paginatorInfoFragment on PaginatorInfo {\n    count\n    currentPage\n    firstItem\n    hasMorePages\n    lastItem\n    lastPage\n    perPage\n    total\n  }\n"]);return i=function(){return e},e}function o(){let e=(0,a._)(["\n  fragment replayPageInfoFragment on PageInfo {\n      endCursor\n      count\n      currentPage\n      hasNextPage\n      hasPreviousPage\n      lastPage\n      startCursor\n      total\n    }\n"]);return o=function(){return e},e}let s=(0,r.Ps)(l()),d=(0,r.Ps)(i()),c=(0,r.Ps)(o());function u(){let e=(0,a._)(["\n  query GetPostsByCategory(\n    $category: String\n    $first: Int = 10\n    $after: String\n  ) {\n    posts(first: $first, after: $after, term_ids: $category) {\n      edges {\n        cursor\n        node {\n          ...postListItemFragment\n          user {\n            name\n          }\n          team {\n            slug\n            name\n          }\n          tags {\n            name\n            slug\n          }\n        }\n      }\n      pageInfo {\n        ...replayPageInfoFragment\n      }\n    }\n  }\n  ","\n  ","\n"]);return u=function(){return e},e}function m(){let e=(0,a._)(["\n  query GetCategorys {\n    categories {\n      id\n      name\n      slug\n    }\n  }\n"]);return m=function(){return e},e}function p(){let e=(0,a._)(["\n  query GetNews($first: Int = 20, $after: String) {\n    posts(first: $first, show_mode: News, after: $after) {\n      edges {\n        cursor\n        node {\n          ...postListItemFragment\n        }\n      }\n      pageInfo {\n        ...replayPageInfoFragment\n      }\n    }\n  }\n  ","\n  ","\n"]);return p=function(){return e},e}function h(){let e=(0,a._)(["\n  query GetPost($slug: String!) {\n    post(slug: $slug) {\n      ...postListItemFragment\n      body\n      source_url\n      user {\n        name\n        nickname\n        image\n      }\n      team {\n        slug\n        name\n        description\n        avatar\n      }\n      tags {\n        name\n        slug\n      }\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function g(){let e=(0,a._)(["\n  query GetPosts(\n    $first: Int = 20\n    $after: String\n    $show_mode: PostShowMode\n    $type: PostType\n    $category: String\n    $tag: String\n  ) {\n    posts(\n      first: $first\n      after: $after\n      show_mode: $show_mode\n      type: $type\n      term_ids: $category\n      tag_ids: $tag\n    ) {\n      edges {\n        cursor\n        node {\n          ...postListItemFragment\n          user {\n            name\n            nickname\n            image\n          }\n          team {\n            slug\n            name\n            avatar\n          }\n          tags {\n            name\n            slug\n          }\n        }\n      }\n      pageInfo {\n        ...replayPageInfoFragment\n      }\n    }\n  }\n  ","\n  ","\n"]);return g=function(){return e},e}function f(){let e=(0,a._)(["\n  query MyPosts(\n    $first: Int!\n    $page: Int\n    $status: [PostStatus]\n    $publish_status: [PostPublishStatus]\n  ) {\n    viewer {\n      name\n      email\n      posts(\n        first: $first\n        page: $page\n        status: $status\n        publish_status: $publish_status\n      ) {\n        data {\n          ...postListItemFragment\n        }\n        paginatorInfo {\n          ...paginatorInfoFragment\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return f=function(){return e},e}function x(){let e=(0,a._)(["\n  query GetHotTags {\n    hotTags {\n      id\n      name\n      slug\n    }\n  }\n"]);return x=function(){return e},e}function b(){let e=(0,a._)(["\n  mutation DeletePost($id: ID!) {\n    deletePost(id: $id) {\n      id\n      slug\n    }\n  }\n"]);return b=function(){return e},e}function v(){let e=(0,a._)(["\n  query GetTag($slug: String!) {\n    tag(slug: $slug) {\n      id\n      name\n      slug\n    }\n  }\n"]);return v=function(){return e},e}function y(){let e=(0,a._)(["\n  query GetEnum($name: String!) {\n    __type(name: $name) {\n      enumValues {\n        name\n      }\n    }\n  }\n"]);return y=function(){return e},e}function k(){let e=(0,a._)(["\n  query Viewer {\n    viewer {\n      name\n      email\n      image\n    }\n  }\n"]);return k=function(){return e},e}function j(){let e=(0,a._)(["\n  query Me {\n    me {\n      name\n      email\n      image\n      team {\n        name\n        slug\n        description\n        avatar\n        status\n      }\n    }\n  }\n"]);return j=function(){return e},e}function w(){let e=(0,a._)(["\n  mutation LoginUser($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      name\n    }\n  }\n"]);return w=function(){return e},e}function C(){let e=(0,a._)(["\n  mutation Logout {\n    logout {\n      name\n    }\n  }\n"]);return C=function(){return e},e}function N(){let e=(0,a._)(["\n  mutation Upload($file: Upload!) {\n    upload(file: $file)\n  }\n"]);return N=function(){return e},e}function S(){let e=(0,a._)(["\n  mutation RemoteFileUpload($url: String!) {\n    remoteFile(url: $url)\n  }\n"]);return S=function(){return e},e}function A(){let e=(0,a._)(["\n  mutation LoginWxCode {\n    loginWxCode\n  }\n"]);return A=function(){return e},e}function L(){let e=(0,a._)(["\n  mutation LoginWxCheck {\n    loginWxCheck\n  }\n"]);return L=function(){return e},e}function T(){let e=(0,a._)(["\n  query GetQuestion($slug: String!) {\n    question(uuid: $slug) {\n      uuid\n      title\n      body\n      keywords\n      answer_count\n      created_at_diff_humans\n      user {\n        name\n        uuid\n        nickname\n        image\n      }\n      answers {\n        uuid\n        body\n        accepted\n        created_at_diff_humans\n        user {\n          name\n          uuid\n          nickname\n          image\n          description\n        }\n      }\n    }\n    randomQuestions {\n      uuid\n      title\n      body\n      keywords\n      answer_count\n      created_at_diff_humans\n    }\n  }\n"]);return T=function(){return e},e}function P(){let e=(0,a._)(["\n  query GetQuestions($first: Int = 20, $after: String) {\n    questions(first: $first, after: $after) {\n      edges {\n        cursor\n        node {\n          uuid\n          title\n          body\n          keywords\n          answer_count\n          created_at_diff_humans\n          user {\n            name\n            nickname\n          }\n        }\n      }\n      pageInfo {\n        ...replayPageInfoFragment\n      }\n    }\n    randomQuestions {\n      uuid\n      title\n      body\n      keywords\n      answer_count\n      created_at_diff_humans\n    }\n  }\n  ","\n"]);return P=function(){return e},e}function M(){let e=(0,a._)(["\n  mutation CreatePost($input: CreatePostInput) {\n    createPost(input: $input) {\n      id\n      title\n      body\n      publish_status\n      status\n      slug\n      user {\n        name\n      }\n    }\n  }\n"]);return M=function(){return e},e}function H(){let e=(0,a._)(["\n  mutation UpdatePost($id: ID!, $input: UpdatePostInput!) {\n    updatePost(id: $id, input: $input) {\n      ...postListItemFragment\n      body\n    }\n  }\n  ","\n"]);return H=function(){return e},e}function I(){let e=(0,a._)(["\n  mutation UpdateUser($input: UpdateUserInput!) {\n    updateUser(input: $input) {\n      uuid\n      name\n    }\n  }\n"]);return I=function(){return e},e}(0,r.Ps)(u(),s,c),(0,r.Ps)(m());let B=(0,r.Ps)(p(),s,c),_=(0,r.Ps)(h(),s),z=(0,r.Ps)(g(),s,c),R=(0,r.Ps)(f(),s,d);(0,r.Ps)(x());let E=(0,r.Ps)(b());(0,r.Ps)(v());let D=(0,r.Ps)(y()),$=(0,r.Ps)(k()),O=(0,r.Ps)(j()),F=(0,r.Ps)(w()),q=(0,r.Ps)(C()),U=(0,r.Ps)(N()),W=(0,r.Ps)(S()),Z=(0,r.Ps)(A()),V=(0,r.Ps)(L()),G=(0,r.Ps)(T()),X=(0,r.Ps)(P(),c),K=(0,r.Ps)(M()),J=(0,r.Ps)(H(),s),Y=(0,r.Ps)(I())},62869:function(e,t,n){"use strict";n.d(t,{d:function(){return s},z:function(){return d}});var a=n(57437),r=n(2265),l=n(37053),i=n(90535),o=n(94508);let s=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:n,variant:r,size:i,asChild:d=!1,...c}=e,u=d?l.g7:"button";return(0,a.jsx)(u,{className:(0,o.cn)(s({variant:r,size:i,className:n})),ref:t,...c})});d.displayName="Button"},88642:function(e,t,n){"use strict";n.d(t,{l0:function(){return u},NI:function(){return b},pf:function(){return v},Wi:function(){return p},xJ:function(){return f},lX:function(){return x},zG:function(){return y}});var a=n(57437),r=n(2265),l=n(37053),i=n(29501),o=n(94508),s=n(6394);let d=(0,n(90535).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(s.f,{ref:t,className:(0,o.cn)(d(),n),...r})});c.displayName=s.f.displayName;let u=i.RV,m=r.createContext({}),p=e=>{let{...t}=e;return(0,a.jsx)(m.Provider,{value:{name:t.name},children:(0,a.jsx)(i.Qr,{...t})})},h=()=>{let e=r.useContext(m),t=r.useContext(g),{getFieldState:n,formState:a}=(0,i.Gc)(),l=n(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...l}},g=r.createContext({}),f=r.forwardRef((e,t)=>{let{className:n,...l}=e,i=r.useId();return(0,a.jsx)(g.Provider,{value:{id:i},children:(0,a.jsx)("div",{ref:t,className:(0,o.cn)("space-y-2",n),...l})})});f.displayName="FormItem";let x=r.forwardRef((e,t)=>{let{className:n,...r}=e,{error:l,formItemId:i}=h();return(0,a.jsx)(c,{ref:t,className:(0,o.cn)(l&&"text-destructive",n),htmlFor:i,...r})});x.displayName="FormLabel";let b=r.forwardRef((e,t)=>{let{...n}=e,{error:r,formItemId:i,formDescriptionId:o,formMessageId:s}=h();return(0,a.jsx)(l.g7,{ref:t,id:i,"aria-describedby":r?"".concat(o," ").concat(s):"".concat(o),"aria-invalid":!!r,...n})});b.displayName="FormControl";let v=r.forwardRef((e,t)=>{let{className:n,...r}=e,{formDescriptionId:l}=h();return(0,a.jsx)("p",{ref:t,id:l,className:(0,o.cn)("text-sm text-muted-foreground",n),...r})});v.displayName="FormDescription";let y=r.forwardRef((e,t)=>{let{className:n,children:r,...l}=e,{error:i,formMessageId:s}=h(),d=i?String(null==i?void 0:i.message):r;return d?(0,a.jsx)("p",{ref:t,id:s,className:(0,o.cn)("text-sm font-medium text-destructive",n),...l,children:d}):null});y.displayName="FormMessage"},95186:function(e,t,n){"use strict";n.d(t,{I:function(){return i}});var a=n(57437),r=n(2265),l=n(94508);let i=r.forwardRef((e,t)=>{let{className:n,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...i})});i.displayName="Input"},49946:function(e,t,n){"use strict";n.d(t,{ApolloWrapper:function(){return u},u:function(){return c}});var a=n(57437),r=n(24614),l=n(32249),i=n(31802),o=n(54992),s=n(6695);let d=(0,l.q)(e=>{let{graphQLErrors:t,networkError:n,operation:a,forward:r}=e;if(t)for(let e of t)"Unauthenticated."===e.message&&(window.location.href="/");n&&console.log("[Network error]: ".concat(n))});function c(){let e=(0,s.Z)({uri:"https://d.pai.com.cn/graphql",credentials:"include"});return new o.p0({cache:new o.ND(m),link:r.i.from([d,e])})}function u(e){let{children:t}=e;return(0,a.jsx)(o.e$,{makeClient:c,children:t})}let m={typePolicies:{Query:{fields:{posts:(0,i.ZB)(["term_ids","tag_ids","show_mode"]),questions:(0,i.ZB)(),viewer:{keyFields:[],merge(e,t,n){let{mergeObjects:a}=n;return a(e,t)}}}},Post:{keyFields:["slug"]},User:{keyFields:["name"]},Team:{keyFields:["slug"]},Question:{keyFields:["uuid"]},Answer:{keyFields:["uuid"]}}}},94508:function(e,t,n){"use strict";n.d(t,{HQ:function(){return i},cn:function(){return l}});var a=n(61994),r=n(53335);function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,a.W)(t))}function i(e,t){return"news"==t?e.includes(".html")?"/news-flash/".concat(e):"/news/".concat(e):e.length<7?"/".concat(e,".html"):"/p/".concat(e)}},65353:function(){},87605:function(){}},function(e){e.O(0,[2443,2297,5558,1537,8311,9900,3572,7902,6137,2972,9485,2995,9064,5878,8341,4992,5345,44,5306,1274,8068,237,9765,409,5097,811,2971,2117,1744],function(){return e(e.s=24735)}),_N_E=e.O()}]);